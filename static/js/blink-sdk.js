var blinkSDK=function(){"use strict";function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},e.apply(this,arguments)}const{LOG_LEVEL:t,IS_PRODUCTION:n,TEST_MODE:s,BLINK_PAY_URL:i,BLINK_API_URL:o,PUBLIC_DATA_BASE_URL:r,BUILD_VERSION:a,BUILD_TIMESTAMP:l,WS_API_URL:d,GOOGLE_PAY_ENV:h,LINKEDIN_CLIENT_ID:c,GOOGLE_CLIENT_ID:u,FACEBOOK_CLIENT_ID:p,TWITTER_CLIENT_ID:m,SOUTHERN_THING_ALIAS:g,TNR_ALIAS:f}={BUILD_VERSION:"4f4ad1b29ad208e5d6d7b4e63c7ec2eedc0c4d23",BUILD_TIMESTAMP:1680869810250,GOOGLE_CLIENT_ID:"1008707048613-2vmm9imdllrf8f5q7ui53qd2b4aucvo9.apps.googleusercontent.com",FACEBOOK_CLIENT_ID:"356180435225530",LINKEDIN_CLIENT_ID:"77z180k7pbxg1j",TWITTER_CLIENT_ID:"EV96Fmj64ExUBZZ0jzLAlsNhr",GOOGLE_PAY_ENV:"TEST",LOG_LEVEL:3,TEST_MODE:!1,SOUTHERN_THING_ALIAS:"southernthing.com",TNR_ALIAS:"newrepublic.com",BLINK_PAY_URL:"https://blink.net",BLINK_API_URL:"https://api.blink.net",WS_API_URL:"wss://ws.blink.net",PUBLIC_DATA_BASE_URL:"https://blink.net/json",IS_PRODUCTION:!0},y="blinkSDKReady",b={widget:"widget",panel:"panel"},v={auth:"auth",subscribe:"subscribe",giftSubscription:"giftSubscription",payment:"payment",donation:"donation",shop:"shop",custom:"custom",newsletter:"newsletter",dashboard:"dashboard",empty:"empty"},w={cover:"cover",preview:"preview",popup:"popup",popupGate:"popupGate",banner:"banner"},A={top:"top",center:"center",bottom:"bottom"},E={replaceChildren:"replaceChildren",firstChild:"firstChild",lastChild:"lastChild"},S=[{selector:".blink-container,#blink-container",type:v.payment},{selector:".blink-donation-container,#blink-donation-container",type:v.donation},{selector:".blink-subscription-container,#blink-subscription-container",type:v.subscribe,gateType:w.preview},{selector:".blink-purchase-container,#blink-purchase-container",type:v.payment,gateType:w.preview},{selector:".blink-newsletter-container,#blink-newsletter-container",type:v.newsletter}],T="data-blink-panel-inserted",C={blinkAction:"blinkAction",createPanel:"createPanel",editPanel:"editPanel",callback:"callback",setVariable:"setVariable"},P=250,I=P+"ms ease",O=375,x=o+"/e/",D="blink-|-",N={loggerLevel:"Logger.loggerLevel",onBoardingBehaviour:"UXManager.onboardingBehaviour",merchantSessionId:"Analytics.sessionId",merchantLocalId:"Analytics.localId",selectedUserJourneys:"UJ-selected",pageVisits:"UJ-visits-",variables:"variables",authToken:"authToken",utm:"utm",referrer:"referrer"},_=["medium","campaign","source","term","content"],k="subscription",L="donation",R="sdkJS",M="publicData",F="iFrameJS",B="sdkInit",U={};function j(e){U[e]=0|performance.now()}function q(){const e=["Android","webOS","iPad","iPhone","iPod","BlackBerry","Windows Phone"];for(let t of e)if(-1!==navigator.userAgent.indexOf(t))return!0;return!1}const W=450,H=650;function z(e){return null==e?[]:Array.isArray(e)?e:[e]}function V(e){if(null!=e&&!1!==e)return e}function G(e){for(;X(e);)e=e();return V(e)}function K(e,t){if(void 0===t&&(t=V),null==e||!1===e)return[];Array.isArray(e)||(e=e[Symbol.iterator]&&!Z(e)?Array.from(e):[e]);let n=[];for(const s of e){if(null==s)continue;const e=Array.isArray(s)?s:t(s);if(null!=e)if(Array.isArray(e)){const s=K(e,t);for(const e of s)n.push(e)}else n.push(e)}let s=n.length===e.length;for(let t=0;s&&t<n.length;t+=1)n[t]!==e[t]&&(s=!1);return s?e:n}function J(e,t){return Q(e)?e+t:e}function Y(e,t){if(e.length>t){const n=e.substring(0,t)+`...[${e.length} initial chr.]`;n.length<e.length&&(e=n)}return e}function $(e,t){return e.__proto__=t.prototype,e}function X(e){return"function"==typeof e}function Q(e){return"number"==typeof e||e instanceof Number}function Z(e){return"string"==typeof e||e instanceof String}function ee(e){return!(!e||"object"!=typeof e||e.constructor&&e.constructor!=Object)}function te(e,t,n){t.forEach(((s,i)=>{i+1<t.length?(e[s]||(e[s]={}),e=e[s]):e[s]=n}))}function ne(){let e=arguments[0]||{};"object"!=typeof e&&"function"!=typeof e&&(e={});for(let t=1;t<arguments.length;t+=1){let n=arguments[t];if(null!=n)for(let[t,s]of Object.entries(n))if(s&&ee(s)||Array.isArray(s)){let n,i=e[t];n=Array.isArray(s)?i&&Array.isArray(i)?i:[]:i&&ee(i)?i:{},e[t]=ne(n,s)}else e[t]=s}return e}const se=()=>{};class CallModifier{wrap(e){throw Error("Implement wrap method")}call(e){return this.wrap(e)()}toFunction(){return e=>this.wrap(e)}}class CallThrottler extends CallModifier{constructor(e){void 0===e&&(e={}),super(),this.lastCallTime=0,this.pendingCall=null,this.pendingCallArgs=[],this.pendingCallExpectedTime=0,this.numCalls=0,this.totalCallDuration=0,Object.assign(this,e)}isThrottleOnAnimationFrame(){return this.throttle===this.constructor.ON_ANIMATION_FRAME}clearPendingCall(){this.pendingCall=null,this.pendingCallArgs=[],this.pendingCallExpectedTime=0}cancel(){this.pendingCall&&this.pendingCall.cancel(),this.clearPendingCall()}flush(){this.pendingCall&&this.pendingCall.flush(),this.clearPendingCall()}cleanup(){this.cancel()}computeExecutionDelay(e){let t=null;return null!=this.throttle&&(t=Math.max(this.lastCallTime+this.throttle-e,0)),null!=this.debounce&&(t=Math.min(null!=t?t:this.debounce,this.debounce)),t}replacePendingCall(e,t,n){if(this.cancel(),this.isThrottleOnAnimationFrame()){const n=requestAnimationFrame(t);return void(e.cancel=()=>cancelAnimationFrame(n))}const s=Date.now();let i=this.computeExecutionDelay(s);if(this.dropThrottled)return 0==i&&t();const o=setTimeout(t,i);e.cancel=()=>clearTimeout(o),this.pendingCall=e,this.pendingCallArgs=n,this.pendingCallExpectedTime=s+i}updatePendingCall(e){if(this.pendingCallArgs=e,!this.isThrottleOnAnimationFrame()){const e=Date.now();this.pendingCallExpectedTime=e+this.computeExecutionDelay(e)}}wrap(e){var t=this;const n=()=>{const t=Date.now();!this.isThrottleOnAnimationFrame()&&t+1<this.pendingCallExpectedTime?this.replacePendingCall(s,n,this.pendingCallArgs):(this.lastCallTime=t,this.clearPendingCall(),e(...this.pendingCallArgs))},s=function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return t.pendingCall&&e===t.pendingCall.originalFunc?t.updatePendingCall(o):t.replacePendingCall(s,n,o)};return s.originalFunc=e,s.cancel=se,s.flush=()=>{s===this.pendingCall&&(this.cancel(),s())},s}}CallThrottler.ON_ANIMATION_FRAME=Symbol(),CallThrottler.AUTOMATIC=Symbol();const ie={};function oe(e,t){if(typeof e!=typeof t)return!1;if(null==e||null==t)return e===t;if(!ee(e)&&!Array.isArray(e))return e===t;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const s of n)if(!oe(e[s],t[s]))return!1;return!0}function re(e){return function(e){try{return JSON.parse(e)}catch(t){try{return JSON.parse(decodeURIComponent(e))}catch(t){try{return decodeURIComponent(e)}catch(e){return null}}}}(new URLSearchParams(window.location.search).get(e))}function ae(){const e=Date.now().toString(16)+parseInt(1e18*Math.random()).toString(16)+parseInt(1e18*Math.random()).toString(16);return[e.substr(0,8),e.substr(8,4),`4${e.substr(12,3)}`,`8${e.substr(15,3)}`,e.substr(18,12)].join("-")}function le(){var e;return null!=(e=ie.iFrameState)&&e.screen&&q()?ie.iFrameState.screen.width:window.screen&&q()?window.screen.width:window.innerWidth}function de(){var e,t;return null!=(e=ie.iFrameState)&&null!=(t=e.screen)&&t.isEmulatorScreen?ie.iFrameState.screen.width<=W:window.screen&&q()?le()<=W:le()<=H}class DispatcherHandle{constructor(e,t){this.dispatcher=e,this.callback=t}remove(){this.dispatcher?(this.dispatcher.removeListener(this.callback),this.dispatcher=void 0,this.callback=void 0):console.warn("Removing a dispatcher twice")}cleanup(){this.remove()}}class Dispatcher{constructor(e){void 0===e&&(e={}),this.options=e,this.listeners=[]}callbackExists(e){for(let t=0;t<this.listeners.length;t+=1)if(this.listeners[t]===e)return!0;return!1}addListener(e){if("function"==typeof e){if(!this.callbackExists(e))return this.listeners.push(e),new DispatcherHandle(this,e);console.error("Can't re-register for the same callback: ",this," ",e)}else console.error("The listener needs to be a function: ",e)}addListenerOnce(e){let t=this.addListener((function(){e(...arguments),t.remove()}));return t}async awaitOnce(){return new Promise((e=>this.addListenerOnce((function(){return e(...arguments)}))))}removeListener(e){for(let t=0;t<this.listeners.length;t+=1)if(this.listeners[t]===e)return this.listeners.splice(t,1)[0]}removeAllListeners(){this.listeners=[]}dispatch(e){for(let e=0;e<this.listeners.length;){let t=this.listeners[e];t(...arguments),t===this.listeners[e]&&e++}}}const he=Symbol("Dispatchers");class Dispatchable{get dispatchers(){return this[he]||(this[he]=new Map)}getDispatcher(e,t){void 0===t&&(t=!0);let n=this.dispatchers.get(e);return!n&&t&&(n=new Dispatcher,this.dispatchers.set(e,n)),n}dispatch(e,t){let n=this.getDispatcher(e,!1);if(n)if(arguments.length<=2)n.dispatch(t);else{let e=Array.prototype.slice.call(arguments,1);n.dispatch(...e)}}addListenerGeneric(e,t,n){return Array.isArray(t)?new CleanupJobs(t.map((t=>this[e](t,n)))):this.getDispatcher(t)[e](n)}addListener(e,t){return this.addListenerGeneric("addListener",e,t)}addListenerOnce(e,t){return this.addListenerGeneric("addListenerOnce",e,t)}removeListener(e,t){const n=this.getDispatcher(e,!1);null==n||n.removeListener(t)}removeAllListeners(e){const t=this.getDispatcher(e,!1);null==t||t.removeAllListeners()}cleanup(){this.runCleanupJobs(),delete this[he]}addCleanupJob(e){return this.hasOwnProperty("_cleanupJobs")||(this._cleanupJobs=new CleanupJobs),this._cleanupJobs.add(e),e}runCleanupJobs(){this._cleanupJobs&&this._cleanupJobs.cleanup()}detachListener(e){this._cleanupJobs?this._cleanupJobs.remove(e):e.remove()}attachTimeout(e,t){const n=setTimeout(e,t);return this.addCleanupJob((()=>clearTimeout(n))),n}attachInterval(e,t){const n=setInterval(e,t);return this.addCleanupJob((()=>clearInterval(n))),n}attachAnimationFrame(e){const t=requestAnimationFrame(e);return this.addCleanupJob((()=>cancelAnimationFrame(t))),t}addChangeListener(e){return this.addListener("change",e)}dispatchChange(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.dispatch("change",...t,this)}}function ce(e){let t="add"+e,n="remove"+e;return function(e){let s=Array.prototype.slice.call(arguments,1),i=e[t](...s);return i||(i=()=>{e[n](...s)}),this.addCleanupJob(i),i}}Dispatchable.prototype.attachListener=ce("Listener"),Dispatchable.prototype.attachEventListener=ce("EventListener"),Dispatchable.prototype.attachCreateListener=ce("CreateListener"),Dispatchable.prototype.attachDeleteListener=ce("DeleteListener"),Dispatchable.prototype.attachChangeListener=ce("ChangeListener"),Dispatchable.prototype.attachListenerOnce=ce("ListenerOnce"),Dispatcher.Global=new Dispatchable;class CleanupJobs{constructor(e){void 0===e&&(e=[]),this.jobs=e}add(e){this.jobs.push(e)}cleanup(){for(let e of this.jobs)"function"==typeof e.cleanup?e.cleanup():"function"==typeof e.remove?e.remove():e();this.jobs=[]}remove(e){if(e){const t=this.jobs.indexOf(e);t>=0&&this.jobs.splice(t,1),e.remove()}else this.cleanup()}}class OnceDispatcher extends Dispatcher{dispatch(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.dispatchArgs=t,super.dispatch(...t)}haveDispatched(){return this.dispatchArgs}addListener(e){if(this.haveDispatched())return e(...this.dispatchArgs),new CleanupJobs;const t=super.addListener((function(){e(...arguments),t.remove()}));return t}addListenerOnce(e){return this.addListener(e)}}let ue=null,pe=null;const me=new OnceDispatcher;function ge(e,t){void 0===t&&(t="merchantId");for(const n of Object.keys(pe&&pe.state||{}))if(n.toLowerCase()===e.toLowerCase()){const e=pe.state[n]||[];return null!=t?e.filter((e=>null==e[t]||e[t]===ue)):e}return[]}function fe(e){return me.addListenerOnce(e)}function ye(){return ue}function be(){return ge("Merchant","id")[0]||null}function ve(){var e;return"active"===(null==(e=be())?void 0:e.sdkStatus)}function we(e){return ge("MerchantUserJourney").find((t=>t.id==e||t.alias==e))}function Ae(){return ge("MerchantPanel")}function Ee(e){return Ae().find((t=>t.id==e||t.alias==e))}function Se(e){return ge("MerchantAudience").find((t=>t.id==e||t.name==e))}class MerchantStorage{constructor(e){this.getStorage=e}getItem(e){try{let t=this.getStorage().getItem(D+e);return JSON.parse(t)}catch(e){return null}}setItem(e,t){try{t=JSON.stringify(t),this.getStorage().setItem(D+e,t)}catch(e){}}removeItem(e){try{this.getStorage().removeItem(D+e)}catch(e){}}}const Te=new MerchantStorage((()=>window.localStorage)),Ce=new MerchantStorage((()=>window.sessionStorage)),Pe={items:new Map,getItem:e=>Pe.items.get(e),setItem:(e,t)=>Pe.items.set(e,t),removeItem:e=>Pe.items.delete(e)},Ie=new MerchantStorage((()=>Pe)),Oe={PERMANENT:"permanent",TAB:"tab",MEMORY:"memory"};function xe(e){return e===Oe.PERMANENT?Te:e===Oe.TAB?Ce:Ie}let De=null,Ne=null;function _e(){if(null==De){const t=Ce.getItem(N.utm)||{};De={};for(const n of _){var e;const s=null!=(e=re(`utm_${n}`))?e:t[n];null!=s&&(De[n]=s)}Object.keys(De).length>0&&Ce.setItem(N.utm,De)}return De}function ke(){return null==Ne&&(Ne=Ce.getItem(N.referrer)||document.referrer||null,Ne&&Ce.setItem(N.referrer,Ne)),Ne}const Le={},Re={utm:_e()},Me=new class MerchantVariableModule extends Dispatcher{constructor(){super(...arguments),this.memory=Ie.getItem(N.variables)||{},this.tab=Ce.getItem(N.variables)||{},this.permanent=Te.getItem(N.variables)||{}}add(e){Object.assign(Re,e)}has(e){return this.memory.hasOwnProperty(e)||this.tab.hasOwnProperty(e)||this.permanent.hasOwnProperty(e)||Re.hasOwnProperty(e)}get(e){return this.memory.hasOwnProperty(e)?this.memory[e]:this.tab.hasOwnProperty(e)?this.tab[e]:this.permanent.hasOwnProperty(e)?this.permanent[e]:Re[e]}set(e,t,n){void 0===n&&(n=Oe.MEMORY),n===Oe.PERMANENT?this.permanent[e]=t:(delete this.permanent[e],n===Oe.TAB?this.tab[e]=t:(delete this.tab[e],this.memory[e]=t)),this.store()}delete(e){delete this.memory[e],delete this.tab[e],delete this.permanent[e],this.store()}all(){return e({},Re,this.permanent,this.tab,this.memory)}store(){Ce.setItem(N.variables,this.tab),Te.setItem(N.variables,this.permanent),Ie.setItem(N.variables,this.memory),this.dispatch()}};function Fe(e,t){let n=null;return()=>{null==n&&(n=setTimeout((()=>{e(),n=null}),t))}}function Be(e,t){let n=null;return()=>{null!=n&&clearTimeout(n),n=setTimeout((()=>{e(),n=null}),t)}}function Ue(){return le()<O?O/le():1}const je=[],qe=Be((function(){console.groupCollapsed("[BlinkSDK] Errors while running journeys");for(const{exception:e,key:t,code:n}of je)console.group(t?"in function "+t:"in anonymous expression:"),n&&console.log(n),console.error(e),console.groupEnd();console.groupEnd(),je.splice(0,je.length)}),10);function We(e,t,n){je.push({exception:e,key:t,code:n}),qe()}const He=new class MerchantFunctionModule{constructor(){this.functions={},this.exceptionHandler=We}get(e){return this.all()[e]}add(e){Object.assign(this.functions,e)}delete(e){delete this.functions[e]}all(){return e({},Le,this.functions)}call(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];Array.isArray(e)&&(n=[...e,...n],[e,...n]=n);let i=this.get(e);if(null==i){const t=Z(e)?e.split("."):[e];let n=window;for(const e of t){if(!n||!n[e]){n=null;break}n=n[e]}i=n}let o=null;if(null==i)return this.handleException(new ReferenceError(`Function not found for key '${e}'.`),e),[!1,null];try{o=i(...n)}catch(t){return this.handleException(t,e),[!1,null]}return[!0,o]}handleException(e,t,n){setTimeout((()=>this.exceptionHandler(e,t,n)),0)}addAnonymous(e){const t="f_"+ae().replace(/-/g,"_");return this.add({[t]:e}),t}};class ExprEvaluator{constructor(t,n){void 0===n&&(n=!0),n&&(t=e({},Me.all(),He.all(),t)),this.context=t}eval(e){return this.rawEvaluator||(this.rawEvaluator=function(e){const t=function(e,t){const n={},s=(e,t)=>e.length-t.length,i=Object.keys(e).sort(s);for(const e of i){const t=e.split(".");te(n,t,`Blink$Variables["${e}"]`)}return Object.keys(n).sort(s).map((e=>`${e} = ${ze(n[e])}`))}(e);let n="'use strict';\n";return t.length>0&&(n+=`var ${t.join(",\n  ")};\n`),t=>{const s=n+"return "+t,i=new Function("Blink$Variables",s);try{return i(e)}catch(e){return He.handleException(e,null,s),null}}}(this.context)),this.rawEvaluator(e)}withExtraContext(t){return new ExprEvaluator(e({},this.context,t),!1)}processPanelNode(t){const n=t.tag.toLowerCase();if("if"===n){const e=this.eval(t.expr)?t.then||t.children:t.else;return this.evaluateNode(e)}if("for"===n){const{entriesExpr:n,indexName:i,varName:o}=function(t){let n="index",s="entry";delete(t=e({},t)).tag,delete t.children,t.indexName&&(n=t.indexName,delete t.indexName);let i=t.entries;if(!t.entries){const e=Object.keys(t);if(1!==e.length)throw Error("Ambiguous For element. The field 'entries' is required, otherwise there should be only one field");s=e[0],i=t[s]}return{entriesExpr:i,indexName:n,varName:s}}(t),r=this.eval(n);let a=[];for(const[e,n]of r.entries()){const r=this.withExtraContext({[o]:n,[i]:e});for(const e of t.children){const t=r.evaluateNode(Z(s=e)?String(s):ne({},s));a.push(t)}}return a}var s;return t}evaluateNode(e){if(Z(e))return e.startsWith("expr:")?this.eval(e.substr(5)):e.replace(/{{([^{}]*)}}/g,((e,t)=>{var n;return String(null!=(n=this.eval(t))?n:"")}));if(Array.isArray(e))return e.map((e=>this.evaluateNode(e)));if(!ee(e))return e;if(Z(e.tag)){const t=this.processPanelNode(e);if(t!==e)return t;e=t}const t={};for(const n of Object.keys(e))t[n]=this.evaluateNode(e[n]);return t}}function ze(e){return Z(e)?e:"{"+Object.keys(e).map((t=>`"${t}": ${ze(e[t])}`)).join(",")+"}"}function Ve(e,t){return new ExprEvaluator(t).evaluateNode(e)}const Ge={parentPanel:null,type:v.custom,subscriptionOffer:null,donationOffer:null,newsletter:null,products:null,skipCTA:!1,editRecurring:!1,dashboardTabs:null,authSocialProviders:["facebook","google","twitter","linkedin"],paymentDetails:null,logoSrc:null,logoAlt:"",logoStyle:{},text:null,textStyle:{},title:null,buttonText:"Continue",actionButtonStyle:{},fonts:[],theme:{},messages:{},metadata:{},content:null,context:null,frame:"logo",gateType:null,customStyle:{},basePanelStyle:{},cancelButtonCustomStyle:{},previewHeight:200,previewFadeOut:!0,previewFadeOutHeight:100,previewFadeOutToColor:"white",coverColor:"rgba(255, 255, 255, 0.9)",coverPanelPosition:A.center,mountType:E.lastChild,get disableUserClose(){return this.inlineFlow},scrimClickCollapse:!0,inlineFlow:!1,onMount:null,onFlowCheckpoint:null,onFlowSuccess:null,onFlowFinish:null,flowSuccessType:null},Ke={[v.subscribe]:{content:'<div style="padding: 20px 30px;text-align: center;">\n            <Text>You need to be a subscriber to access this content.</Text>\n            <SubscribeButton label="Subscribe"></SubscribeButton>\n            <LoginFooter label="Already a subscriber?"></LoginFooter>\n            <PoweredByBlink></PoweredByBlink>\n        </div>'},[v.giftSubscription]:{content:'<div style="padding: 20px 30px;text-align: center;">\n        <Text>Gift a subscription to someone you love!</Text>\n        <GiftSubscriptionButton label="Gift a subscription"></GiftSubscriptionButton>\n        <PoweredByBlink></PoweredByBlink>\n    </div>'},[v.donation]:{content:'<div style="padding: 20px 30px;text-align: center;">\n            <Text><strong>{{publisher_name}}</strong> relies on support from readers like yourself. Even a small amount would help us improve our coverage.</Text>\n            <DonateButton label="Donate"></DonateButton>\n            <LoginFooter label="Already a donor?"></LoginFooter>\n            <PoweredByBlink></PoweredByBlink>\n        </div>'},[v.payment]:{content:'<div style="padding: 20px 30px;text-align: center;">\n        <Text>{{publisher_name}} uses Blink to allow access to individual articles.</Text>\n        <PurchaseButton></PurchaseButton>\n        <If expr="!blinkSDK.isAuthenticated()">\n            <Text>Get <b>$2</b> credit when you create an account.</Text>            \n        </If>\n        <LoginFooter label="Already purchased?"></LoginFooter>\n        <PoweredByBlink></PoweredByBlink>\n    </div>'},[v.newsletter]:{content:'<div style="padding: 20px 30px;text-align: center;">\n        <Text>Subscribe to our newsletter to keep yourself updated with our latest content.</Text>\n        <NewsletterButton></NewsletterButton>\n        <PoweredByBlink></PoweredByBlink>\n    </div>'}};function Je(t,n){n&&Object.assign(t,n,{fonts:[...t.fonts||[],...n.fonts||[]],theme:e({},t.theme,n.theme),messages:e({},t.messages,n.messages),metadata:e({},t.metadata,n.metadata),context:e({},t.context,n.context)})}function Ye(e,t){return e.find((e=>e.id==t||e.alias==t))}function $e(e){for(const t of Object.keys(e))t.startsWith("analytics-")&&(e["data-"+t]=e[t]);return e}function Xe(t){Z(t.content)?t.contentAST=function(t,n){void 0===n&&(n=e=>e);const s=(new DOMParser).parseFromString(`<body>${t}</body>`,"text/xml"),i=t=>{if(t.nodeType===Node.TEXT_NODE){const e=t.wholeText;let n=e.trim();return n?(n[0]!==e[0]&&(n=" "+n),n[n.length-1]!==e[e.length-1]&&(n+=" "),n):null}if(t.nodeType!==Node.ELEMENT_NODE)return null;let s={};return t.getAttributeNames().forEach((e=>{s[e]=t.getAttribute(e)})),n(e({tag:t.tagName,children:[...t.childNodes].map(i).filter(Boolean)},s))};return[...s.childNodes[0].childNodes].map(i).filter(Boolean)}(t.content,$e):t.contentAST=ne({},t.content),t.contentAST=Ve(t.contentAST,t.context)}function Qe(e,t,n){void 0===t&&(t=Ae()),void 0===n&&(n=Me.all()),e=function(e,t,n){var s,i;void 0===n&&(n={});const o={};Je(o,Ge);const r=be();r&&Je(o,{context:{publisher_name:r.name,merchant_name:r.name}});const a=[];let l=e.panel;for(;null!=l;){const e=Ye(t,l);if(null==e)break;a.push(e),l=e.options.parentPanel}0===a.length&&!e.type&&Object.values(v).indexOf(e.panel)>=0&&(e.type=e.panel,delete e.panel);const d=e.type||(null==(s=a.find((e=>{var t;return null==e||null==(t=e.options)?void 0:t.type})))||null==(i=s.options)?void 0:i.type),h=Ye(t,d);d!==v.custom&&h&&a.push(h);const c=Ke[d];c&&a.push({options:c});const u=Ye(t,"base");u&&a.push(u);const p=a[0];Je(o,{metadata:{panelId:null==p?void 0:p.id,panelAlias:(null==p?void 0:p.alias)||o.type}});for(const e of a.reverse())Je(o,e.options);return Je(o,{context:n}),Je(o,e),o.mountType||(o.mountType=o.gateType?E.lastChild:E.replaceChildren),window.isInPreviewMode&&(o.isInPreviewMode=!0),o}(e,t,n),Xe(e);for(const t of Object.keys(e))"context"!==t&&"parentPanel"!==t&&"content"!==t&&"contentAST"!==t&&(e[t]=Ve(e[t],e.context));return e}function Ze(e,t){if(Array.isArray(e)){for(const n of e)Ze(n,t);return}const n=Ee(e);n&&(n.options=n.options||{},Je(n.options,t))}const et="blinkPay-",tt={UPDATE_SDK_USER_DATA:"updateSdkUserData",CREATE_IFRAME_APP:"createIframeApp",IFRAME_HTML_LOADED:"iFrameHtmlLoaded",REQUEST_AMAZON_PAY:"requestAmazonPay",ROUTE_CHANGE:"routeChange",TRANSITION_CHANGE:"transitionChange",SHOW_AUTOPAY:"showAutopay",START_FLOW_REQUEST:"startFlowRequest",UPDATE_PANEL_SIZE:"updatePanelSize",REQUEST_UPDATE_PANEL_SIZE:"requestUpdatePanelSize",UPDATE_PANEL_CONTENT:"updatePanelContent",CHECK_FLOW_SUCCESS:"checkFlowDone",SCROLL_IFRAME_TOP:"scrollIframeTop",DESTROY_PANEL:"destroyPanel",USER_TOKEN_UPDATE:"userTokenUpdate",REDIRECT_TO_URL:"redirectToUrl",SET_MERCHANT_TOKEN:"setMerchantToken",UPDATE_MERCHANT_TOKEN:"updateMerchantToken",SESSION_PAYMENT_MADE:"sessionPaymentMade",MAKE_PAYMENT_VIA_SDK:"makePaymentViaSDK",MAKE_NEXT_PAYMENT_MANUALLY:"makeNextPaymentManually",WIDGET_DATA_LOADED:"widgetDataLoaded",UPDATE_GLOBAL_STATE:"updateGlobalState",UPDATE_ANALYTICS_DATA_FROM_SDK:"updateAnalyticsDataFromSDK",AMAZON_PAY_EVENT:"amazonPayEvent",PAYMENT_REQUEST:"paymentRequest",PAYMENT_RESPONSE:"paymentResponse",UPDATE_APP_STATE:"updateAppState",REPOSITION_WIDGET:"repositionWidget",ANALYTICS_EVENT:"analyticsEvent",FLOW_CHECKPOINT:"flowCheckpoint"};function nt(e){return et+e}function st(e){if(!e)return;let t="",n="";for(;e&&e!==document.body;e=e.parentNode){t=e.className.split(" ").map((e=>e?"."+CSS.escape(e):"")).join("")+(e.id?"#"+CSS.escape(e.id):"")+n+t;let s=e.tagName.toLowerCase();if(1===document.querySelectorAll(s+t).length)return s+t;n=e.parentNode?`>:nth-child(${[...e.parentNode.children].indexOf(e)+1})`:""}return e?e.tagName.toLowerCase()+t:t}const it={key:"pageView",flush:!0},ot={key:"flowStart",flush:!0},rt={key:"custom",flush:!0};let at=null;class AnalyticsClient extends Dispatchable{constructor(e){super(),this.eventQueue=[],this.environment={},this.identity={},this.preprocessors=[],this.origin=e,this.submitEnqueuedEventsDebounced=Be((()=>this.submitEnqueuedEvents()),100),at=this}addNodeAnalyticsData(e,t){if(e.dataset)for(const[s,i]of Object.entries(e.dataset))if(s.startsWith("analytics")&&"analytics"!==s){const e=(n=s.slice(9))&&n.charAt(0).toLowerCase()+n.slice(1);t.hasOwnProperty(e)||(t[e]=i)}var n;const s=e.parentElement;s&&this.addNodeAnalyticsData(s,t)}addEventNodeDataToPayload(t,n){var s;let i=t.currentTarget||t.target;if(i===document&&(i=t.target||t.currentTarget),null!=(s=i)&&s.tagName){const s={};this.addNodeAnalyticsData(i,s),n.domEventType=t.type,n.domEventTarget=e({selector:st(i),text:Y(i.innerText,200)},s)}}submitEnqueuedEvents(e){if(0===this.eventQueue.length)return;const t=(e=>JSON.stringify({method:"xhr",origin:this.origin,identity:this.identity,events:this.eventQueue}))();this.eventQueue=[];const n=new XMLHttpRequest;n.open("POST",x,!0),n.send(t)}enqueueEvent(t,n){void 0===n&&(n={});const s=self.event;s&&this.addEventNodeDataToPayload(s,n);let i={type:t.key,timestamp:+Date.now()/1e3,localSessionTime:performance.now()/1e3,payload:e({},this.environment,n)};for(const e of this.preprocessors)i=e(i)||i;this.dispatch("event",e({origin:this.origin,identity:e({},this.identity)},i)),this.eventQueue.push(i),this.eventQueue.length>=16?this.submitEnqueuedEvents():t.flush&&(t.now?this.submitEnqueuedEvents(1):this.submitEnqueuedEventsDebounced())}updateEnvironment(e){Object.assign(this.environment,e)}updateIdentity(e){Object.assign(this.identity,e)}}function lt(e,t){void 0===t&&(t={});try{var n;null==(n=at)||n.enqueueEvent(e,t)}catch(e){console.error("Blink analytics caught an error:",e)}}const dt=new class SDKMessagingChannelClass extends Dispatchable{constructor(){super(),this.attachEventListener(window,"message",(t=>{if(t.origin!==i||"object"!=typeof t.data)return;const{data:n}=t,{appType:s,type:o}=n;if(!("string"==typeof o||o instanceof String)||!o.startsWith(et))return;const r=[...document.getElementsByTagName("iframe")].find((e=>e.contentWindow===t.source)),a=e({},n,{type:n.type.substring(et.length),origin:t.origin});this.dispatch(a.type,a,r,s)}))}},ht=new OnceDispatcher;function ct(e,t){let n=[];const s=()=>{e.getAttribute("htmlLoaded")&&e.contentWindow&&(n.forEach((t=>e.contentWindow.postMessage(t,"*"))),n=[])};if(!e.getAttribute("htmlLoaded")){const n=dt.addListener(tt.IFRAME_HTML_LOADED,((i,o)=>{let{version:r}=i;o===e&&(e.setAttribute("htmlLoaded",!0),t===b.widget&&ht.dispatch(r),s(),n.remove())}))}return function(e,i){void 0===i&&(i={}),i.type=nt(e),i.appType=t,n.push(i),s()}}class NodeElement extends Dispatchable{constructor(t,i){void 0===t&&(t={}),void 0===i&&(i=null),super(),this.options=e({},this.getDefaultOptions(),t),this.node=i||document.createElement(this.options.nodeType),n&&!s||this.options.testId&&this.node.setAttribute("test-id",this.options.testId)}getDefaultOptions(){return{nodeType:"div",style:{}}}updateOptions(e){Object.assign(this.options,e),this.refreshStyle(),n&&!s||this.node&&e.testId&&this.node.setAttribute("test-id",e.testId)}refreshStyle(){this.setStyle(this.options.style)}mount(e,t){var n;void 0===t&&(t=null),null==t?e.appendChild(this.node):e.insertBefore(this.node,null==(n=e.children)?void 0:n[t]),this.refreshStyle(),this.onMount()}setStyle(e,t){this.node&&("object"==typeof e?Object.assign(this.node.style,e):this.node.style[e]=t)}destroyNode(){var e;this.cleanup(),null==(e=this.node)||e.remove(),delete this.node}onMount(){this.attachEventListener(window,"resize",Fe((()=>this.refreshStyle()),100))}}const ut=new class SDKState extends Dispatchable{constructor(){super(...arguments),this.preferredEmail=null,this.allowUserToCoverFees=!1,this.hideWallet=!1}update(e){Object.assign(this,e),this.dispatchChange(e)}},pt=new Set,mt=new Dispatcher;class IFrameElement extends NodeElement{constructor(e,t){void 0===e&&(e={}),void 0===t&&(t=null),super(e,t),this.lastSentIframeParams=null,this.node.src||(this.node.src=`${i}/iframe.html`,this.node.sandbox="allow-popups allow-scripts allow-same-origin allow-popups-to-escape-sandbox  allow-top-navigation-by-user-activation allow-forms",this.node.frameBorder=0),this.sendMessage=ct(this.node,this.appType)}get appType(){return null}getDefaultOptions(){return e({},super.getDefaultOptions(),{nodeType:"iframe",testId:"blinkIframe"})}updateOptions(e){super.updateOptions(e),this.resendIFrameParams()}getIFrameParams(){return e({},this.options,{forceHideWallet:ut.hideWallet,preferredEmail:ut.preferredEmail,allowUserToCoverFees:ut.allowUserToCoverFees,screen:{width:Ue()*le(),height:Ue()*document.documentElement.clientHeight,isEmulatorScreen:!0},merchantPageUrl:window.location.href||"",merchantPageReferrerUrl:ke()})}resendIFrameParams(){if(!this.node)return void(this.lastSentIframeParams=null);const e=this.getIFrameParams();oe(e,this.lastSentIframeParams)||(this.lastSentIframeParams=e,this.sendMessage(tt.UPDATE_APP_STATE,{iframeParams:e}))}addSdkListener(e,t){this.attachListener(dt,e,((e,n,s)=>{n===this.node&&s===this.appType&&t(e)}))}getIFrameInitData(){return{merchantId:ye(),publicData:pe,iframeParams:this.getIFrameParams(),merchantToken:Te.getItem(N.authToken)||Ce.getItem(N.authToken),appType:this.appType}}initialize(){this.addCleanupJob(fe((()=>{ve()?(this.sendMessage(tt.CREATE_IFRAME_APP,{iFrameInitData:this.getIFrameInitData()}),pt.add(this),mt.dispatch(this),this.addCleanupJob((()=>pt.delete(this)))):this.destroyNode()})))}onMount(){super.onMount(),this.initialize(),this.attachChangeListener(ut,(()=>this.resendIFrameParams())),this.attachEventListener(window,"resize",Fe((()=>this.resendIFrameParams()),20)),n&&!s||this.addSdkListener(tt.TRANSITION_CHANGE,(e=>{let{transitioning:t}=e;(this.constructor.totalTransitioning||t)&&(this.constructor.totalTransitioning+=t?1:-1,this.node.setAttribute("transitioning",this.constructor.totalTransitioning>0))}))}}function gt(e,t){return void 0===t&&(t=0),(null==e?void 0:e.activeUntil)&&Date.now()-new Date(e.activeUntil).getTime()<t}IFrameElement.totalTransitioning=0;const ft={userPreferencesChange:new Dispatcher,authenticationChange:new Dispatcher,subscriptionChange:new Dispatcher,userData:{userId:null,alwaysShowBalance:null,showOnboarding:null,subscription:null,activeRecurringDonation:null,latestOneTimeDonation:null,newsletterIds:[]},init(){dt.addListener(tt.UPDATE_SDK_USER_DATA,(t=>{let{userData:n}=t;const s=e({},this.userData);Object.assign(this.userData,n),s.userId!==n.userId&&this.authenticationChange.dispatch(),oe(s.subscription,n.subscription)||this.subscriptionChange.dispatch(n.subscription),oe(s,n)||this.userPreferencesChange.dispatch()})),dt.addListener(tt.SET_MERCHANT_TOKEN,(e=>{let{token:t}=e;return this.setMerchantToken(t)}))},setMerchantToken(e){e?(Te.setItem(N.authToken,e),Ce.setItem(N.authToken,e)):(Te.removeItem(N.authToken),Ce.removeItem(N.authToken)),pt.forEach((t=>{t.sendMessage(tt.UPDATE_MERCHANT_TOKEN,{token:e})}))},isAuthenticated(){return null!=this.userData.userId},isRecurringDonor(){return gt(this.userData.activeRecurringDonation)},isDonor(){return gt((e=this.userData).activeRecurringDonation)||gt(e.latestOneTimeDonation,7776e6);var e},isSubscriber(){return gt(this.userData.subscription)},isNewsletterSubscriber(e){return e=e.newsletterId||e,this.userData.newsletterIds.includes(e)},exposeMerchantFunctions(){var e=this;const t={};for(const n in this)n.startsWith("is")&&(t[n]=function(){return!!e[n](...arguments)});return t}},yt={INDEX_COLLAPSED:"empty",INDEX_EXPANDED:"widget-index-expanded",ADD_FUNDS:"widget-add-funds",AUTOPAY:"widget-autopay",ADD_CARD:"widget-add-card",CHOOSE_CARD:"widget-choose-card",INSUFFICIENT_FUNDS:"widget-insufficient-funds"},bt={gate:{pointerEvents:"initial",height:"100%",display:"flex"}};class GateElement extends NodeElement{constructor(e,t){super(e),this.styleSheet=bt,this.panel=t}refreshStyle(){var e;super.refreshStyle(),this.setStyle(this.styleSheet.gate),Object.assign(this.parentNode.style,this.computeParentStyle()),this.panel.updateOptions({style:this.getPanelStyle()}),this.setStyle(null!=(e=this.options.customStyle)?e:{})}getPanelStyle(){return{maxWidth:"100%",minWidth:"100%",border:0,height:0}}computeParentStyle(){return{}}mount(e){this.initialParentStyle={};for(const t of e.style)this.initialParentStyle[t]=e.style[t];this.parentNode=e,this.options.mountType===E.replaceChildren?(e.innerHTML="",super.mount(e,0)):this.options.mountType===E.firstChild?super.mount(e,0):this.options.mountType===E.lastChild&&super.mount(e,e.childNodes.length),this.panel.mount(this.node)}destroyNode(){this.panel.destroyNode();const e={};for(const t of Object.keys(this.computeParentStyle()))e[t]="";Object.assign(this.parentNode.style,e,this.initialParentStyle),super.destroyNode()}getInteractiveHandlers(){return{remove:()=>{this.node?this.destroyNode():console.error("Panel has already been destroyed.")},updatePanel:e=>{this.panel?this.panel.updateOptions(e):console.error("Panel has already been destroyed.")}}}onMount(){super.onMount(),this.panel.sizeChange.addListener((()=>this.refreshStyle())),this.panel.addSdkListener(tt.DESTROY_PANEL,(()=>{this.destroyNode()})),this.attachEventListener(document,"visibilitychange",(()=>{"visible"===document.visibilityState&&this.refreshStyle()}))}}const vt={gate:e({},bt.gate,{top:0,left:0,width:"100%",height:"100%",position:"absolute"}),panelBasicStyle:{position:"absolute"},panelStyle:{[A.top]:{top:0,bottom:"auto"},[A.center]:{margin:"auto",top:0,bottom:0},[A.bottom]:{top:"auto",bottom:0}}},wt={gate:e({},bt.gate,{display:"flex",flexDirection:"column",position:"absolute",boxSizing:"border-box",width:"100%",top:0,left:0})},At={close:{background:"linear-gradient(60deg, #085B68, #064953)",width:"52px",height:"52px",borderRadius:"100%",position:"absolute",zIndex:5,overflow:"hidden",transition:I,outline:0,cursor:"pointer",border:"none","-webkit-user-select":"none",userSelect:"none",boxShadow:"none",textShadow:"none"},collapsed:{opacity:0,transform:"scale(0)"},expanded:{opacity:1,transform:"scale(1)"}};class WidgetClose extends NodeElement{constructor(){super(...arguments),this.pointerEventsTimeout=null,this.node.innerHTML='<svg width="18px" style="margin:auto" version="1.1" viewBox="0 0 16 16"><g fill="none" fill-rule="evenodd"><g transform="translate(-1221 -791)" fill="#fff" fill-rule="nonzero"><g transform="translate(896 395)"><g transform="translate(306 377)"><g transform="translate(14.5 14.5)"><polygon points="19.792 6.6771 18.323 5.2083 12.5 11.031 6.6771 5.2083 5.2083 6.6771 11.031 12.5 5.2083 18.323 6.6771 19.792 12.5 13.969 18.323 19.792 19.792 18.323 13.969 12.5"/></g></g></g></g></g></svg>'}getDefaultOptions(){return e({},super.getDefaultOptions(),{testId:"blinkWidgetCloseButton",expanded:!1,positionBottom:0,positionRight:0,activePanel:!1,visible:!1})}refreshStyle(){super.refreshStyle(),this.setStyle(At.close);const e=this.options.positionBottom+680+72;this.setStyle({display:de()||e>document.documentElement.clientHeight?"none":"flex",bottom:this.options.positionBottom+"px",right:this.options.positionRight+"px"}),clearTimeout(this.pointerEventsTimeout),this.options.expanded&&!this.options.activePanel&&this.options.visible?(this.setStyle(At.expanded),this.pointerEventsTimeout=this.attachTimeout((()=>{this.setStyle("pointerEvents","all")}),P)):(this.setStyle(At.collapsed),this.setStyle("pointerEvents","none"),this.node.blur())}}const Et={background:"none",height:"52px",borderRadius:"40px",position:"absolute",zIndex:3,display:"flex",outline:0,cursor:"pointer",border:"none","-webkit-user-select":"none","-webkit-tap-highlight-color":"transparent",userSelect:"none",boxShadow:"none",textShadow:"none"};class WidgetButton extends NodeElement{constructor(){super(...arguments),this.pointerEventsTimeout=null}getDefaultOptions(){return e({},super.getDefaultOptions(),{testId:"blinkWidgetButton",expanded:!1,positionBottom:0,positionRight:0,activePanel:!1,visible:!1})}refreshStyle(){super.refreshStyle(),this.setStyle(e({},Et,{width:(this.options.showBalance?114:52)+"px",bottom:this.options.positionBottom+"px",right:this.options.positionRight+"px"})),clearTimeout(this.pointerEventsTimeout),this.options.expanded||this.options.activePanel||!this.options.visible?(this.setStyle("pointerEvents","none"),this.node.blur()):this.pointerEventsTimeout=this.attachTimeout((()=>{this.setStyle("pointerEvents","all")}),P)}}const St={widget:{border:"none",zIndex:2,overflow:"hidden",alignSelf:"flex-end",position:"absolute",height:"100%",width:"100%",bottom:0,transition:P+"ms ease"},skipTransition:{transition:"none"},expandedMobile:{height:"100%",left:0,right:0,margin:"0 auto"},expandedDesktop:{left:"",right:"",margin:""},collapsed:{transform:"",transformOrigin:"",left:"",pointerEvents:"none"}};class Widget extends IFrameElement{constructor(){super(...arguments),this.pointerEventsTimeout=null,this.visibilityTimeout=null,this.skipTransition=!1}get appType(){return b.widget}getDefaultOptions(){return e({},super.getDefaultOptions(),{positionBottom:0,route:yt.INDEX_COLLAPSED,expanded:!1,visible:!1,activePanel:!1})}updateOptions(e){var t,i;(null!=e.positionBottom&&e.positionBottom!==this.options.positionBottom&&(this.skipTransition=!0),super.updateOptions(e),!n||s)&&(e.route&&(null==(t=this.node)||t.setAttribute("route",e.route)),!1===e.activePanel&&(null==(i=this.node)||i.setAttribute("panel-type",v.empty)),this.attachTimeout((()=>{var e;null==(e=this.node)||e.setAttribute("expanded",this.options.expanded||this.options.activePanel)}),P))}refreshStyle(){super.refreshStyle(),this.setStyle(St.widget),this.skipTransition&&(this.setStyle(St.skipTransition),this.skipTransition=!1),clearTimeout(this.pointerEventsTimeout),clearTimeout(this.visibilityTimeout),this.options.activePanel||this.options.visible&&this.options.expanded?(de()?this.setStyle(St.expandedMobile):this.setStyle(St.expandedDesktop),this.setStyle("visibility","visible"),this.pointerEventsTimeout=this.attachTimeout((()=>{this.setStyle("pointerEvents","all")}),P)):(this.setStyle(St.collapsed),this.visibilityTimeout=this.attachTimeout((()=>{this.setStyle("visibility",ut.hideWallet?"hidden":"visible")}),P))}onMount(){super.onMount();const e=Fe((()=>{this.refreshStyle(),this.sendMessage(tt.REPOSITION_WIDGET)}),100);this.attachEventListener(window,"resize",e),this.attachEventListener(window,"orientationchange",e)}}let Tt=!1;const Ct={position:"fixed",pointerEvents:"none",transition:"opacity ease .3s",display:"flex",flexDirection:"column",top:0,left:0,opacity:1,caretColor:"transparent",outline:"none",cursor:"default",zIndex:9999999,width:"100%",overflow:"initial",visibility:"visible"};class WidgetContainer extends NodeElement{getDefaultOptions(){return e({},super.getDefaultOptions(),{desktopBottomOffset:0,mobileBottomOffset:0,visible:!1,showBalance:!1,expanded:!1,activePanel:!1})}constructor(){super(...arguments),this.widget=new Widget,this.widgetClose=new WidgetClose,this.widgetButton=new WidgetButton,this.node.classList.add("blink-sdk-widget-container")}getOffset(){return{positionBottom:24+(de()?this.options.mobileBottomOffset:this.options.desktopBottomOffset),positionRight:(de()?10:24)+(this.options.extraRightOffset||0)}}mountOnBody(){const e=()=>{document.body?(this.mount(document.body),this.widget.mount(this.node),this.widgetClose.mount(this.node),this.widgetButton.mount(this.node),fe((()=>{ve()||this.destroyNode()}))):requestAnimationFrame(e)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}updateOptions(e){super.updateOptions(e);const{expanded:t,showBalance:n,visible:s,activePanel:i}=this.options;this.widget.updateOptions({expanded:t,activePanel:i,visible:s}),this.widgetClose.updateOptions({expanded:t,activePanel:i,visible:s&&ft.isAuthenticated()}),this.widgetButton.updateOptions({expanded:t,showBalance:n,activePanel:i,visible:s&&ft.isAuthenticated()})}refreshStyle(){super.refreshStyle(),this.setStyle(Ct),this.setStyle(function(){if(le()>=O)return{width:"100%",transform:"",height:"100%"};if(!Tt){const e=document.createElement("style");e.innerHTML="body>.blink-sdk-widget-container {max-width: initial !important;}",document.head.appendChild(e),Tt=!0}return{width:`${O}px`,transform:`scale(${1/Ue()})`,transformOrigin:"top left",height:100*Ue()+"%"}}());const e=this.getOffset();this.widget.updateOptions(e),this.widgetClose.updateOptions(e),this.widgetButton.updateOptions(e)}}const Pt=60,It=230,Ot="#4897a3";function xt(e,t,n){const s=()=>{const t=(Date.now()-o)/n;!document.body.contains(e)||t>1?i.remove():(Object.assign(i.style,(t=>{const n=de()?.4:1,s=Pt+t*(It-Pt),{left:i,top:o,width:r,height:a}=e.getBoundingClientRect();return{position:"fixed",left:i+r/2-s/2+"px",top:o+a/2-s/2+"px",height:s+"px",width:s+"px",opacity:n*(1-t),zIndex:1,borderRadius:"100%",backgroundColor:Ot,cursor:"pointer",pointerEvents:"none"}})(t)),requestAnimationFrame(s))},i=document.createElement("div");let o;return document.body.appendChild(i),setTimeout((()=>{o=Date.now(),requestAnimationFrame(s)}),t),i}const Dt=new Set(["border-radius","border-bottom-left-radius","border-bottom-right-radius","border-top-left-radius","border-top-right-radius","border-bottom-width","border-left-width","border-right-width","border-top-width","border-width","bottom","font-size","font-stretch","height","layer-grid-char","layer-grid-char-spacing","layer-grid-line","left","letter-spacing","line-height","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","max-height","max-width","min-height","min-width","outline-width","padding","padding-bottom","padding-left","padding-right","padding-top","right","size","top","width","word-spacing"]);class ClassNameSet extends Set{static create(e){return $(new Set(String(e||"").split(" ")),this)}toString(){return Array.from(this).join(" ")}}class NodeAttributes{constructor(t){Object.assign(this,t),this.className instanceof ClassNameSet&&(this.className=ClassNameSet.create(String(this.className))),ee(this.style)&&(this.style=e({},this.style))}setAttribute(e,t,n,s){void 0===s&&(s=this.constructor.defaultAttributesMap),s.has(e)||(this.whitelistedAttributes=this.whitelistedAttributes||{},this.whitelistedAttributes[e]=!0),this[e]=t,n&&this.applyAttribute(e,n,s)}applyStyleToNode(e,t,n){"function"==typeof t&&(t=t()),Q(t)&&0!=t&&Dt.has(function(e){let t="";for(let n=0;n<e.length;n++)"A"<=e[n]&&e[n]<="Z"?(n>0&&(t+="-"),t+=e[n].toLowerCase()):t+=e[n];return t==e?e:t}(e))&&(t+="px"),n&&n.style[e]!==t&&(n.style[e]=t)}ensureNoStringStyle(){Z(this.style)&&(this.styleString=this.style,delete this.style)}setStyle(e,t,n){if(Z(e))void 0!==t?(this.ensureNoStringStyle(),this.style=this.style||{},this.style[e]=t,this.applyStyleToNode(e,t,n)):this.removeStyle(e,n);else for(const t of Object.keys(e))this.setStyle(t,e[t],n)}removeStyle(e,t){this.style&&delete this.style[e],t&&t.style[e]&&delete t.style[e]}static getClassArray(e){return e?Array.isArray(e)?e.map((e=>String(e).trim())):String(e).trim().split(" "):[]}getClassNameSet(){return this.className instanceof ClassNameSet||(this.className=ClassNameSet.create(this.className||"")),this.className}addClass(e,t){e=this.constructor.getClassArray(e);for(let n of e)this.getClassNameSet().add(n),t&&t.classList.add(n)}removeClass(e,t){e=this.constructor.getClassArray(e);for(let n of e)this.getClassNameSet().delete(n),t&&t.classList.remove(n)}hasClass(e){return this.getClassNameSet().has(Z(e)?e:e.className)}applyAttribute(e,t,n){let s=n.get(e);if(!s){if(!this.whitelistedAttributes||!(e in this.whitelistedAttributes))return;s={domName:e}}let i=this[e];"function"==typeof i&&(i=i()),s.noValue&&(i=i?"":void 0),void 0!==i?t.setAttribute(s.domName,i):t.removeAttribute(s.domName)}applyClassName(e){if(this.className){const t=String(this.className);e.className!=t&&(e.className=t)}else e.className&&e.removeAttribute("class")}apply(e,t){let n={};this.whitelistedAttributes;let s=e.attributes;for(let i=s.length-1;i>=0;i--){let o=s[i].name;if("style"===o||"class"===o)continue;let r=t.getKeyFromDOMName(o);if(this.hasOwnProperty(r)){let s=this[r],i=t.get(r);i&&i.noValue&&(s=s?"":void 0),null!=s?(e.setAttribute(o,s),n[r]=!0):e.removeAttribute(o)}else e.removeAttribute(o)}for(let s in this)n[s]||this.applyAttribute(s,e,t);if(this.applyClassName(e),e.removeAttribute("style"),this.ensureNoStringStyle(),this.styleString&&(e.style=this.styleString),this.style)for(const t of Object.keys(this.style))this.applyStyleToNode(t,this.style[t],e)}}function Nt(e){self.STEM_DEBUG&&(e.node.stemElement=e)}NodeAttributes.defaultAttributesMap=new class DOMAttributesMap{constructor(e,t,n){void 0===t&&(t=[]),void 0===n&&(n=[]),this.allowedAttributesMap=new Map,this.reverseNameMap=new Map,this.fallbackMapping=e;for(let e of t)Array.isArray(e)||(e=[e]),this.setAttribute(e[0],e[1]);this.allowedPrefixes=n}setAttribute(e,t){(t=t||{}).domName=t.domName||e,this.allowedAttributesMap.set(e,t),this.reverseNameMap.set(t.domName,e)}get(e){for(const t of this.allowedPrefixes)if(e.startsWith(t))return{domName:e};let t=this.allowedAttributesMap.get(e);return!t&&this.fallbackMapping&&(t=this.fallbackMapping.get(e)),t}has(e){return this.allowedAttributesMap.has(e)||this.fallbackMapping&&this.fallbackMapping.has(e)}getKeyFromDOMName(e){let t=this.reverseNameMap.get(e);return!t&&this.fallbackMapping&&(t=this.fallbackMapping.getKeyFromDOMName(e)),t}}(null,[["id"],["action"],["checked",{noValue:!0}],["colspan"],["default"],["disabled",{noValue:!0}],["fixed"],["forAttr",{domName:"for"}],["hidden"],["href"],["rel"],["minHeight"],["minWidth"],["role"],["target"],["domTitle",{domName:"title"}],["type"],["placeholder"],["src"],["alt"],["height"],["width"],["tabIndex"]],["data-","aria-"]);class ThemeType{constructor(e,t,n){Z(n=n||{})&&(n={comment:n}),this.type=e,this.value=t,this.options=n}}class Theme extends Dispatchable{constructor(t,n,s){super(),this.classSet=new Set,this.styleSheetInstances=new Map,this.updateThrottled=new CallThrottler({throttle:50}).wrap((()=>this.updateStyleSheets())),this.name=n,this.baseTheme=t,this.properties=e({theme:this},s),this.propTypes={},this.props=new Proxy(this.properties,{get:(e,t,n)=>{let s=this.getProperty(t);return X(s)&&(s=s(this.props)),self.STEM_DEBUG&&void 0===s&&console.warn("Failed to find theme prop",t),s},set:(e,t,n)=>(this.setProperties({[t]:n}),n)}),this.styleSheetSymbol=Symbol(this.name+"StyleSheet"),window.addEventListener("resize",(()=>this.updateThrottled()))}fork(e,t){return new Theme(this,e,t)}register(e,t){e.theme=this,e[this.styleSheetSymbol]=t,this.classSet.add(e)}getStyleSheet(e){var t;return e[this.styleSheetSymbol]||(null==(t=this.baseTheme)?void 0:t.getStyleSheet(e))}getProperty(e){var t;return this.properties.hasOwnProperty(e)?this.properties[e]:null==(t=this.baseTheme)?void 0:t.getProperty(e)}setProperties(e,t){void 0===t&&(t=!0);for(const[t,n]of Object.entries(e))n instanceof ThemeType?(this.properties[t]=n.value,this.propTypes[t]=n):this.properties[t]=n;t&&this.updateThrottled()}getAllStyleSheets(){let e=new Set(this.styleSheetInstances.values());for(const t of this.classSet.values())e.add(this.getStyleSheet(t));return Array.from(e).map((e=>e.getInstance(this)))}getStyleSheetInstance(e){let t=this.styleSheetInstances.get(e);return t||(t=new e({theme:this}),this.styleSheetInstances.set(e,t)),t}updateStyleSheets(){this.dispatch("beforeUpdateStyleSheets");for(const e of this.getAllStyleSheets())e.update();this.dispatch("afterUpdateStyleSheets")}static register(e,t){return this.Global.register(...arguments)}static setProperties(e){this.Global.setProperties(...arguments)}static get props(){return this.Global.props}}Theme.Global=new Theme(null,"Global");const _t=[],kt=new class OncePerTickRunner{constructor(e){this.callback=e,this.throttle=new WeakMap}maybeEnqueue(e){return!this.throttle.get(e)&&(this.throttle.set(e,!0),queueMicrotask((()=>{this.throttle.get(e)&&(this.clear(e),this.callback(e))})),!0)}clear(e){this.throttle.delete(e)}}((e=>e.node&&e.redraw())),Lt={};function Rt(e){return K(e,G)}class BaseUIElement extends Dispatchable{canOverwrite(e){return this.constructor===e.constructor&&this.getNodeType()===e.getNodeType()}applyRef(){var e,t;null!=(e=this.options)&&e.ref&&(this.options.ref.parent[null!=(t=this.options.ref.name)?t:this.options.ref.key]=this);this.cancelEnqueuedRedraw()}removeRef(){var e;if(null!=(e=this.options)&&e.ref){let e=this.options.ref.parent,t=this.options.ref.name;e[t]===this&&(e[t]=void 0)}}enqueueRedraw(){kt.maybeEnqueue(this)}cancelEnqueuedRedraw(){kt.clear(this)}onMount(){}onUnmount(){}destroyNode(){var e;this.dispatch("unmount",this),this.onUnmount(),this.cleanup(),this.removeRef(),null==(e=this.node)||e.remove(),delete this.node}}Lt.TextElement=class UITextElement extends BaseUIElement{constructor(e){var t;void 0===e&&(e=""),super(),e&&e.hasOwnProperty("value")&&ee(e)?(this.value=e.value,this.options=e):this.value=null!=(t=e)?t:""}mount(e,t){this.parent=e,this.node?this.redraw():(this.createNode(),this.applyRef()),e.node.insertBefore(this.node,t),this.onMount()}getNodeType(){return Node.TEXT_NODE}copyState(e){this.value=e.value,this.options=e.options}createNode(){return this.node=document.createTextNode(this.getValue()),Nt(this),this.node}setValue(e){this.value=null!=e?e:"",this.node&&this.redraw()}getValue(){return String(this.value)}toString(){return this.getValue()}redraw(){if(this.node){let e=this.getValue();this.node.nodeValue!==e&&(this.node.nodeValue=e)}this.applyRef()}};class UIElement extends BaseUIElement{constructor(e){void 0===e&&(e={}),super(),this.children=[],this.options=e,this.state=this.getDefaultState(),this.setOptions(e)}getDefaultOptions(e){}getCleanedOptions(){let t=e({},this.options);return delete t.ref,delete t.children,delete t.key,delete t.nodeType,t}getDefaultState(){return{}}getPreservedOptions(){}setOptions(e){let t=this.getDefaultOptions(e);t&&(e=Object.assign(t,e)),this.options=e}updateOptions(e){this.setOptions(Object.assign(this.options,e)),this.redraw()}setChildren(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.updateOptions({children:Rt(t)})}copyState(e){let t=e.options,n=this.getPreservedOptions();n&&(t=Object.assign({},t,n)),this.setOptions(t),this.addListenersFromOptions()}getNodeType(){return this.options.nodeType||"div"}static create(e,t){const n=new this(t);return n.mount(e,null),n.dispatch("mount",n),n}getGivenChildren(){return this.options.children||[]}render(){return this.options.children}createNode(){return this.node=document.createElement(this.getNodeType()),Nt(this),this.node}cleanup(){this.runCleanupJobs();for(const e of this.children)e.destroyNode();this.clearNode(),super.cleanup()}overwriteChild(e,t){return e.copyState(t),e}getElementKeyMap(e){if(!e||!e.length)return;let t=new Map;for(let n=0;n<e.length;n+=1){let s=e[n].options&&e[n].options.key||"autokey"+n;t.set(s,e[n])}return t}getChildrenToRender(){return this.render()}getExtraContext(){const{theme:e}=this.options;return e?{theme:e}:null}updateContext(t){var n;void 0===t&&(t=null==(n=this.parent)?void 0:n.context);const s=this.getExtraContext();this.context=s?e({},t,s):t}getChildrenForRedraw(){_t.push(this);let e=Rt(this.getChildrenToRender());return _t.pop(),e}redraw(){if(!this.node)return console.error("Element not yet mounted. Redraw aborted!",this),!1;this.updateContext();let e=this.getChildrenForRedraw();if(e===this.children){for(const t of e)t.redraw();return this.applyNodeAttributes(),this.applyRef(),!0}let t=this.node,n=this.getElementKeyMap(this.children);for(let i=0;i<e.length;i++){var s;let o=e[i],r=i>0?e[i-1].node:null,a=r?r.nextSibling:t.firstChild;o.getNodeType||(o=o.toUI?o.toUI(this):new Lt.TextElement({value:String(o)}),e[i]=o);let l=(null==(s=o.options)?void 0:s.key)||"autokey"+i,d=n&&n.get(l);d&&e[i].canOverwrite(d)?(d!==e[i]&&(e[i]=this.overwriteChild(d,e[i])),e[i].redraw(),e[i].node!==a&&t.insertBefore(e[i].node,a)):o.mount(this,a)}if(this.children.length){let t=new Set(e);for(const e of this.children)t.has(e)||e.destroyNode()}return this.children=e,this.applyNodeAttributes(),this.applyRef(),!0}getOptionsAsNodeAttributes(){return $(this.options,NodeAttributes)}instantiateNodeAttributes(){return new NodeAttributes(this.options)}getNodeAttributes(){var e;const t=this.instantiateNodeAttributes(),n=null==(e=this.styleSheet)?void 0:e.container;return n&&t.addClass(n),t}extraNodeAttributes(e){}applyNodeAttributes(){const e=this.getNodeAttributes();this.extraNodeAttributes(e),e.apply(this.node,this.constructor.domAttributesMap)}setAttribute(e,t){this.getOptionsAsNodeAttributes().setAttribute(e,t,this.node,this.constructor.domAttributesMap)}setStyle(e,t){if("object"!=typeof e)this.getOptionsAsNodeAttributes().setStyle(e,t,this.node);else for(const[t,n]of Array.from(Object.entries(e)))this.setStyle(t,n)}removeStyle(e){this.getOptionsAsNodeAttributes().removeStyle(e,this.node)}addClass(e){this.getOptionsAsNodeAttributes().addClass(e,this.node)}removeClass(e){this.getOptionsAsNodeAttributes().removeClass(e,this.node)}hasClass(e){return this.getOptionsAsNodeAttributes().hasClass(e)}toggleClass(e){this.hasClass(e)?this.removeClass(e):this.addClass(e)}getTheme(){var e;return this.options.theme||(null==(e=this.context)?void 0:e.theme)||Theme.Global}get styleSheet(){var e;let{styleSheet:t}=this.options;const n=this.getTheme();return t||(t=n.getStyleSheet(this.constructor)),null==(e=t)?void 0:e.getInstance(n)}get themeProps(){var e;return(null==(e=this.options.styleSheet)?void 0:e.themeProps)||this.getTheme().props}addListenersFromOptions(){var e=this;for(const t in this.options)if("string"==typeof t&&t.startsWith("on")&&t.length>2){const n=t.substring(2),s="add"+n+"Listener",i="on"+n+"Handler";"function"!=typeof this[s]||this.hasOwnProperty(i)||(this[i]=function(){if(e.options[t]){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];e.options[t](...s,e)}},this[s](this[i]))}}refLink(e){return{parent:this,name:e}}refLinkArray(e,t){return this[e]||(this[e]=[]),{parent:this[e],name:t}}bindToNode(e,t){return this.node=e,t&&(this.clearNode(),this.redraw()),this}mount(e,t){if(e.node||(e=(new Lt.Element).bindToNode(e)),this.parent=e,this.node)return e.insertChildNodeBefore(this,t),void this.dispatch("changeParent",this.parent);this.createNode(),this.redraw(),e.insertChildNodeBefore(this,t),this.addListenersFromOptions(),this.onMount()}appendChild(e){if(this.children!==this.options.children)throw"Can't properly handle appendChild, you need to implement it for "+this.constructor;return this.options.children.push(e),e.mount(this,null),e}insertChild(e,t){if(this.children!==this.options.children)throw"Can't properly handle insertChild, you need to implement it for "+this.constructor;t=t||0,this.options.children.splice(t,0,e);const n=t+1<this.options.children.length?this.children[t+1].node:null;return e.mount(this,n),e}eraseChild(e,t){void 0===t&&(t=!0);let n=this.options.children.indexOf(e);return n<0?null:this.eraseChildAtIndex(n,t)}eraseChildAtIndex(e,t){if(void 0===t&&(t=!0),e<0||e>=this.options.children.length)return void console.error("Erasing child at invalid index ",e,this.options.children.length);if(this.children!==this.options.children)throw"Can't properly handle eraseChild, you need to implement it for "+this.constructor;let n=this.options.children.splice(e,1)[0];return t?n.destroyNode():this.node.removeChild(n.node),n}show(){this.removeClass("hidden")}hide(){this.addClass("hidden")}insertChildNodeBefore(e,t){this.node.insertBefore(e.node,t)}clearNode(){for(;this.node&&this.node.lastChild;)this.node.removeChild(this.node.lastChild)}isInDocument(){return document.body.contains(this.node)}getWidthOrHeight(e){let t=this.node;return t&&parseFloat("width"===e?t.offsetWidth:t.offsetHeight)||0}getHeight(){return this.getWidthOrHeight("height")}getWidth(){return this.getWidthOrHeight("width")}setHeight(e){this.setStyle("height",J(e,"px")),this.dispatch("resize")}setWidth(e){this.setStyle("width",J(e,"px")),this.dispatch("resize")}addNodeListener(e,t){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];this.node.addEventListener(e,t,...s);const o={remove:()=>{this.removeNodeListener(e,t,...s)}};return this.addCleanupJob(o),o}removeNodeListener(e,t){this.node.removeEventListener(e,t)}addClickListener(e){return this.addNodeListener("click",e)}removeClickListener(e){this.removeNodeListener("click",e)}addDoubleClickListener(e){return this.addNodeListener("dblclick",e)}removeDoubleClickListener(e){this.removeNodeListener("dblclick",e)}}Lt.createElement=function(e,t){if(e){t=t||{};for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];if(t.children=Rt(s),t.ref){if("string"==typeof t.ref){if(!(_t.length>0))throw Error("Failed to automatically link ref, there needs to be an element in the rendering stack");t.ref={parent:_t[_t.length-1],name:t.ref}}t.key&&console.error("Warning! UI Element cannot have both a key and a ref fieldname. Key will be overriden.\nAre you using the options from another object? Shame!",t),t.key="_ref"+t.ref.name}return t.hasOwnProperty("class")&&console.error("Invalid UI Element attribute: class. Did you mean className?"),"string"==typeof e&&(t.nodeType=e,e=UIElement),new e(t)}console.error("Create element needs a valid object tag, did you mistype a class name?")},UIElement.domAttributesMap=NodeAttributes.defaultAttributesMap,Lt.Element=UIElement,Lt.str=e=>new Lt.TextElement(e);let Mt=new WeakMap;Lt.Primitive=(e,t)=>{t||(t=e,e=Lt.Element);let n=Mt.get(e);n||(n=new Map,Mt.set(e,n));let s=n.get(t);return s||(s=class Primitive extends e{getNodeType(){return t}},n.set(t,s),s)};class ScriptResolver extends Dispatchable{constructor(e){super(),this.loaded=!1,this.jobs=[];let t=document.createElement("script");t.async=!0,t.src=e,t.onload=()=>this.onLoad(),document.getElementsByTagName("head")[0].appendChild(t)}onLoad(){this.loaded=!0;for(let e=0;e<this.jobs.length;e+=1)this.jobs[e](this);this.jobs=[]}resolve(e){this.loaded?e(this):this.jobs.push(e)}}let Ft=new Map;function Bt(t,n,s,i){const o=e({},s,{appType:i,type:nt(n)});t===window&&window.postBlinkMessageSync?window.postBlinkMessageSync(o):t.postMessage(o,"*")}const Ut=new class IFrameConnection extends Dispatchable{constructor(){super(),this.appType=null,this.allIframesDispatch=new Dispatchable,window.blinkIframeConnections?window.blinkIframeConnections.push(this):window.blinkIframeConnections=[this],window.postBlinkMessageSync||(window.postBlinkMessageSync=function(e){for(const t of window.blinkIframeConnections)t.processWindowEventData(e)}),this.attachEventListener(window,"message",(e=>{let{data:t}=e;"object"==typeof t&&(e.source===window&&this.appType===t.appType||(t.eventOrigin=e.origin,this.processWindowEventData(t)))}))}processWindowEventData(e){e.eventOrigin||(e.eventOrigin=window.location.origin);const{type:t}=e;("string"==typeof t||t instanceof String)&&t.startsWith(et)&&(this.allIframesDispatch.dispatch(t.substring(et.length),e),e.appType&&this.appType&&this.appType!==e.appType||this.dispatch(t.substring(et.length),e))}setAppType(e){this.appType=e}sendToSDK(e,t){void 0===t&&(t={}),Bt(window.parent,e,t,this.appType)}sendToOpener(e,t){void 0===t&&(t={}),Bt(window.opener,e,t,this.appType)}sendToIFrames(e,t){void 0===t&&(t={});const{frames:n}=window.parent;for(let s=0;s<n.length;s+=1)try{const i=n[s];i.origin===window.origin&&Bt(i,e,t,this.appType)}catch(e){}}addIframesListener(e,t){return this.allIframesDispatch.addListener(e,(function(e){if(e.eventOrigin===window.origin){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];t(e,...s)}}))}},jt={popup:"true",scope:"profile postal_code payments:widget payments:shipping_address"};let qt=null;class AmazonPayWidget extends Lt.Element{constructor(){super(...arguments),this.userData=null}static show(e){const{publicConfig:t}=e.amazonPaymentProcessor;this.isReady?this.insertModal(e):(window.onAmazonLoginReady=()=>{amazon.Login.setClientId(t.clientId),amazon.Login.setSandboxMode(t.sandbox),amazon.Login.setMerchantID(t.merchantId),this.isReady=!0,this.insertModal(e)},async function(e,t){Array.isArray(e)||(e=[e]);let n=e.map((e=>async function(e){let t=Ft.get(e);return t||(t=new ScriptResolver(e),Ft.set(e,t)),new Promise((function(e,n){t.resolve(e,n)}))}(e)));Promise.all(n).then((function(){t&&t(...arguments)}))}(t.sandbox?"https://static-na.payments-amazon.com/OffAmazonPayments/us/sandbox/js/Widgets.js":"https://static-na.payments-amazon.com/OffAmazonPayments/us/js/Widgets.js"))}static insertModal(e){amazon.Login.authorize(jt,(()=>this.create(document.body,e)))}static requestWidgetInSDK(e,t){this.finishCallback=t,e=e.toSDK(),Ut.sendToSDK(tt.REQUEST_AMAZON_PAY,{amazonPaymentProcessor:e}),this.addedSDKListeners||(this.addedSDKListeners=!0,Ut.addListener(tt.AMAZON_PAY_EVENT,(e=>{this.finishCallback(e.orderReferenceId),this.finishCallback=null})))}extraNodeAttributes(e){e.setStyle({zIndex:99999910,height:"100%",width:"100%",position:"fixed",background:"gray",top:0,left:0,opacity:1,display:"flex",alignItems:"center",justifyContent:"center"})}getAmazonConfig(){return this.options.amazonPaymentProcessor.publicConfig}getAmazonSellerId(){return this.getAmazonConfig().merchantId}updateRecurringPaymentConsent(e){const t="true"==e.getConsentStatus();this.okButton.updateOptions({disabled:!t})}finishFlow(e){if(e&&this.orderReferenceId){const{iframeElement:e}=this.options,t={orderReferenceId:this.orderReferenceId};ct(e,"panel")(tt.AMAZON_PAY_EVENT,t)}this.destroyNode()}render(){const e={fontFamily:"sans-serif",fontSize:14,height:40,width:120,borderRadius:4,cursor:"pointer",margin:"0px 8px"};return Lt.createElement("div",{style:{width:"100%",maxWidth:375,boxSizing:"border-box",background:"white",padding:20}},Lt.createElement("div",{id:"walletWidgetDiv",style:{height:228,width:"100%",marginBottom:16}}),Lt.createElement("div",{id:"consentWidgetDiv",style:{height:140,width:"100%",margin:"16px 0px"}}),Lt.createElement("div",{style:{marginTop:16,textAlign:"center"}},Lt.createElement("button",{style:e,onClick:()=>this.finishFlow()},"Cancel"),Lt.createElement("button",{style:e,ref:"okButton",disabled:!0,onClick:()=>this.finishFlow(!0)},"OK")))}async onAmazonAuth(e){this.showPaymentWidget()}showAddressWidget(){new OffAmazonPayments.Widgets.AddressBook({sellerId:this.getAmazonSellerId(),agreementType:"BillingAgreement",onReady:e=>{console.warn("Got billing agreement:",e.getAmazonBillingAgreementId(),e,performance.now())},onAddressSelect:e=>{console.warn("Address select:",e,performance.now())},design:{designMode:"responsive"},onError:e=>{console.error("Amazon address widget error:",e.getErrorCode(),e.getErrorMessage())}}).bind("addressBookWidgetDiv")}showPaymentWidget(){new OffAmazonPayments.Widgets.Wallet({sellerId:this.getAmazonSellerId(),design:{designMode:"responsive"},agreementType:"BillingAgreement",onReady:e=>{qt.billingAgreementId=e.getAmazonBillingAgreementId(),console.warn("Billing agreement",qt.billingAgreementId,e)},onOrderReferenceCreate:e=>{qt.orderReferenceId=e.getAmazonOrderReferenceId(),console.log("Order ref",qt.orderReferenceId,e)},onPaymentSelect:e=>{console.warn("Payment selected: ",this.orderReferenceId,e),qt.showRecurringPaymentConsentWidget()},onError:e=>{console.error("Amazon payment widget error:",e.getErrorCode(),e.getErrorMessage())}}).bind("walletWidgetDiv")}showRecurringPaymentConsentWidget(){new OffAmazonPayments.Widgets.Consent({sellerId:this.getAmazonSellerId(),amazonBillingAgreementId:this.orderReferenceId,design:{designMode:"responsive"},onReady:e=>{qt.updateRecurringPaymentConsent(e)},onConsent:e=>{qt.updateRecurringPaymentConsent(e)},onError:e=>{console.error("Amazon payment widget error:",e.getErrorCode(),e.getErrorMessage())}}).bind("consentWidgetDiv")}onMount(){qt=this,this.showPaymentWidget()}}AmazonPayWidget.addedSDKListeners=!1;const Wt=new class PurchaseModule{constructor(){this.paymentRequestReceived=new Dispatcher,this.paymentRequestCompleted=new Dispatcher,this.paymentRequests=new Map,this.paymentCallbacks=new Map,this.pendingRequests=[],this.lastPaymentRequestData={}}init(){dt.addListener(tt.MAKE_PAYMENT_VIA_SDK,(e=>{let{request:t}=e;return this.requestPayment(t)})),dt.addListener(tt.PAYMENT_RESPONSE,(e=>{let{request:t,response:n,error:s}=e;const i=this.paymentCallbacks.get(t.offerId)||{onSuccess:[],onError:[]};n?(this.paymentRequests.set(t.offerId,{request:t,response:n}),i.onSuccess.forEach((e=>e(n))),i.onSuccess=[]):(this.paymentRequests.set(t.offerId,{request:t,error:s}),i.onError.forEach((e=>e(s))),i.onError=[],t.offerId===this.lastPaymentRequestData.offerId&&1207===s.code&&Ht.changeRoute(yt.INSUFFICIENT_FUNDS)),this.paymentRequestCompleted.dispatch()}))}resolvePendingRequests(){const e=this.pendingRequests;this.pendingRequests=null;for(const t of e)this.requestPayment(...t)}requestPayment(e,t,n){if(void 0===t&&(t=se),void 0===n&&(n=se),null!=this.pendingRequests)return void this.pendingRequests.push(arguments);this.lastPaymentRequestData=e,this.paymentRequests.set(e.offerId,{request:e});const s=this.paymentCallbacks.get(e.offerId)||{onSuccess:[],onError:[]};s.onSuccess.push(t),s.onError.push(n),this.paymentCallbacks.set(e.offerId,s),this.paymentRequestReceived.dispatch(),Ht.widget.sendMessage(tt.PAYMENT_REQUEST,e)}};class PanelElement extends IFrameElement{constructor(){super(...arguments),this.flowCheckpoint=new Dispatcher,this.flowFinish=new Dispatcher,this.flowSuccess=new Dispatcher,this.sizeChange=new Dispatcher,this.height=null,this.width=null,n&&!s||(this.node.setAttribute("route",this.options.type),this.node.setAttribute("panel-type",this.options.type),this.node.setAttribute("gate-type",this.options.gateType),this.node.setAttribute("expanded",!1))}get appType(){return b.panel}getPaymentDetails(){return this.options.paymentDetails||Wt.lastPaymentRequestData}getPaymentRequestStatus(){const e=this.getPaymentDetails();return Wt.paymentRequests.get(null==e?void 0:e.offerId)}getIFrameParams(){return e({},super.getIFrameParams(),{paymentDetails:this.getPaymentDetails()})}isFlowSuccess(){const e=z(this.options.flowSuccessType||this.options.type),t={[v.subscribe]:()=>ft.isSubscriber()&&!this.options.inlineFlow&&!this.options.editRecurring,[v.payment]:()=>{var e;return null!=(null==(e=this.getPaymentRequestStatus())?void 0:e.response)},[v.auth]:()=>ft.isAuthenticated()};for(const n of e){const e=t[n];if(e&&e())return n}return null}checkFlowSuccess(){const e=this.isFlowSuccess();e&&this.flowSuccess.dispatch(e)}recalcPanelContent(){Xe(this.options);const{contentAST:e}=this.options;this.sendMessage(tt.UPDATE_PANEL_CONTENT,{contentAST:e})}refreshStyle(){super.refreshStyle(),this.setStyle({visibility:"visible"}),this.height&&this.width&&this.options.gateType!==w.popup&&this.setStyle({height:Q(this.height)?this.height+"px":this.height,width:Q(this.width)?this.width+"px":this.width,transition:I})}destroyNode(){return this.flowFinish.dispatch(),super.destroyNode()}onMount(){super.onMount(),this.addSdkListener(tt.UPDATE_PANEL_SIZE,(e=>{let{height:t,width:i}=e;t<50||(this.height=t,this.width=i,this.refreshStyle(),this.sizeChange.dispatch({height:t,width:i}),n&&!s||this.attachTimeout((()=>this.node.setAttribute("expanded","true")),P))})),this.addSdkListener(tt.CHECK_FLOW_SUCCESS,(()=>{this.checkFlowSuccess()})),this.attachEventListener(window,"resize",Fe((()=>this.sendMessage(tt.REQUEST_UPDATE_PANEL_SIZE)))),this.attachEventListener(document,"visibilitychange",(()=>{"visible"===document.visibilityState&&this.sendMessage(tt.REQUEST_UPDATE_PANEL_SIZE)})),this.addSdkListener(tt.SCROLL_IFRAME_TOP,(e=>{var t;let{windowScroll:n}=e;null==(t=this.node)||t.scrollIntoView({behavior:"smooth"}),n&&window.scrollTo(n)})),this.addSdkListener(tt.FLOW_CHECKPOINT,(e=>{let{event:t}=e;return this.flowCheckpoint.dispatch(t)})),this.attachListener(Wt.paymentRequestReceived,(()=>this.resendIFrameParams())),this.attachListener(Wt.paymentRequestCompleted,(()=>this.resendIFrameParams())),n&&!s||this.addSdkListener(tt.ROUTE_CHANGE,(e=>{let{route:t}=e;this.node.setAttribute("route",t)})),this.attachListener(ft.authenticationChange,(()=>{this.recalcPanelContent()})),this.checkFlowSuccess(),this.attachListener(ft.userPreferencesChange,(()=>this.checkFlowSuccess())),this.attachListener(Wt.paymentRequestCompleted,(()=>this.checkFlowSuccess()))}}const Ht=new class WalletModule{constructor(){this.scrim=null,this.panelDestroyTimeout=null,this.panelDestroyFunction=null,this.pendingChangeRoutes=[],this.currentRoute=yt.INDEX_COLLAPSED,this.pulseAnimation=void 0,this.activePanelHandler=void 0,this.widgetContainer=new WidgetContainer}init(){this.widgetContainer.mountOnBody(),this.widgetContainer.widgetButton.node.addEventListener("click",(()=>this.changeRoute(yt.INDEX_EXPANDED))),this.widgetContainer.widgetClose.node.addEventListener("click",(()=>this.changeRoute(yt.INDEX_COLLAPSED))),dt.addListener(tt.ROUTE_CHANGE,((e,t)=>{t===this.widget.node&&this.onRouteChange(e)})),dt.addListener(tt.SHOW_AUTOPAY,(()=>{this.changeRoute(yt.AUTOPAY)})),dt.addListener(tt.SESSION_PAYMENT_MADE,(()=>{ut.hideWallet||this.isExpanded()||this.isPopupFlowActive()||(this.pulseAnimation=function(e){const t=xt(e,0,1e3),n=xt(e,250,1250);return{remove(){t.remove(),n.remove()}}}(this.widgetContainer.widgetButton.node))})),dt.addListener(tt.REQUEST_AMAZON_PAY,((t,n)=>{AmazonPayWidget.show(e({},t,{iframeElement:n}))})),ft.userPreferencesChange.addListener((()=>this.widgetContainer.updateOptions({showBalance:!!ft.userData.alwaysShowBalance})))}get widget(){return this.widgetContainer.widget}renderWallet(e){var t,n;this.widgetContainer.updateOptions({desktopBottomOffset:null!=(t=null==e?void 0:e.desktop)?t:0,mobileBottomOffset:null!=(n=null==e?void 0:e.mobile)?n:0,visible:!ut.hideWallet});const s=()=>{const e=()=>{this.widgetContainer.updateOptions({visible:!ut.hideWallet}),this.updateScrim()};this.isExpanded()&&ut.hideWallet?setTimeout(e,P):e(),ut.hideWallet&&!this.isPopupFlowActive()&&this.isExpanded()&&this.changeRoute(yt.INDEX_COLLAPSED)};ft.authenticationChange.addListener(s),ut.addChangeListener(s),s()}changeRoute(e){this.isPopupFlowActive()?this.pendingChangeRoutes.push(arguments):this.widget.sendMessage(tt.ROUTE_CHANGE,{route:e})}showModal(e){if(this.panelDestroyFunction&&this.panelDestroyFunction(),this.isPopupFlowActive()){const e=this.activePanelHandler;setTimeout((()=>e.remove()))}else this.changeRoute(yt.INDEX_COLLAPSED),this.widgetContainer.updateOptions({expanded:!1});const t=new PanelElement(e,this.widget.node),n={panel:t,remove:()=>{n===this.activePanelHandler&&t.sendMessage(tt.ROUTE_CHANGE,{url:v.empty}),this.panelDestroyFunction=()=>{n===this.activePanelHandler&&(this.activePanelHandler=null),t.node=null,t.destroyNode(),this.widgetContainer.updateOptions({activePanel:this.isPopupFlowActive()});for(const e of this.pendingChangeRoutes)this.changeRoute(...e);this.pendingChangeRoutes=[],this.updateScrim(),this.panelDestroyFunction=null,clearTimeout(this.panelDestroyTimeout),this.panelDestroyTimeout=null},this.panelDestroyTimeout=setTimeout(this.panelDestroyFunction,300)},updatePanel:e=>{n===this.activePanelHandler?t.updateOptions(e):console.error("Panel has already been destroyed.")}};return this.activePanelHandler=n,this.widgetContainer.updateOptions({activePanel:!0}),t.onMount(),t.resendIFrameParams(),t.sendMessage(tt.ROUTE_CHANGE),this.activePanelHandler=n,this.updateScrim(),t.addSdkListener(tt.DESTROY_PANEL,(e=>{let{expandWallet:t}=e;n.remove(),t&&this.changeRoute(yt.INDEX_EXPANDED)})),{panel:t,handler:n}}isExpanded(){return this.currentRoute!==yt.INDEX_COLLAPSED}isPopupFlowActive(){return!!this.activePanelHandler}updateScrim(){this.isPopupFlowActive()||!ut.hideWallet&&this.isExpanded()?this.scrim||(this.scrim=function(){const e=document.documentElement.clientHeight!==document.documentElement.scrollHeight?document.documentElement:document.body,t=window.innerWidth-e.clientWidth,n=getComputedStyle(e),s=n.getPropertyValue("padding-right"),i={overflow:n.getPropertyValue("overflow"),paddingRight:s};return i.overflow.endsWith("hidden")?{scrollbarWidth:t,restore:se}:(Object.assign(e.style,{overflow:"hidden",paddingRight:`${parseFloat(s)+t}px`}),{scrollbarWidth:t,restore:()=>{Object.assign(e.style,i)}})}(),this.widgetContainer.updateOptions({extraRightOffset:this.scrim.scrollbarWidth})):this.scrim&&(this.widgetContainer.updateOptions({extraRightOffset:0}),this.scrim.restore(),this.scrim=null)}onRouteChange(e){-1!==Object.values(yt).indexOf(e.route)&&e.appType===b.widget&&(this.currentRoute=e.route),this.isPopupFlowActive()||this.widget.updateOptions({route:this.currentRoute}),this.widgetContainer.updateOptions({expanded:this.isExpanded()}),this.updateScrim(),this.isExpanded()&&this.pulseAnimation&&(this.pulseAnimation.remove(),this.pulseAnimation=null)}},zt={gate:e({},bt.gate,{background:"#FFF",boxShadow:"0px -2px 4px rgba(0, 0, 0, 0.1)",display:"flex",boxSizing:"border-box",left:0,bottom:0,width:"100%",position:"fixed",zIndex:9999997,height:null})},Vt={gate:e({},bt.gate,{top:0,left:0,width:"100%",height:"100%",position:"fixed",background:"rgba(154, 151, 151, 0.88)"})},Gt={[w.cover]:class CoverGate extends GateElement{constructor(){super(...arguments),this.styleSheet=vt}getPanelStyle(){return e({},super.getPanelStyle(),this.styleSheet.panelBasicStyle,this.styleSheet.panelStyle[this.options.coverPanelPosition])}refreshStyle(){super.refreshStyle(),this.setStyle("background",this.options.coverColor)}},[w.preview]:class PreviewGate extends GateElement{constructor(){super(...arguments),this.styleSheet=wt,this.preview=document.createElement("div"),this.node.appendChild(this.preview),this.options.previewFadeOut&&(this.fadeOut=document.createElement("div"),Object.assign(this.fadeOut.style,{background:`linear-gradient(rgba(255,255,255,0),${this.options.previewFadeOutToColor})`,height:this.options.previewFadeOutHeight+"px"}),this.node.appendChild(this.fadeOut))}refreshStyle(){var e;super.refreshStyle(),Object.assign(this.preview.style,{height:this.options.previewHeight+"px"}),this.setStyle(null!=(e=this.options.customStyle)?e:{})}getPanelStyle(){return e({},super.getPanelStyle(),{background:this.options.previewFadeOutToColor})}computeParentStyle(){var t,n,s;const i=((null==(t=this.preview)?void 0:t.offsetHeight)||0)+((null==(n=this.fadeOut)?void 0:n.offsetHeight)||0)+((null==(s=this.panel)?void 0:s.height)||0)+"px";return e({},super.computeParentStyle(),{overflow:"hidden",minHeight:i,maxHeight:i,height:i})}},[w.banner]:class BannerGate extends GateElement{constructor(){super(...arguments),this.styleSheet=zt}refreshStyle(){var e;super.refreshStyle(),this.setStyle(null!=(e=this.options.customStyle)?e:{})}},[w.popupGate]:class PopupGate extends GateElement{constructor(){super(...arguments),this.styleSheet=Vt}computeParentStyle(){return{overflow:"hidden",paddingRight:"15px"}}}},Kt=new class PanelModule{constructor(){this.pendingRequests=[],this.rules=S,this.cachedBannerGates=new Map}init(){new PanelElement({type:v.empty,gateType:w.popup},Ht.widget.node).initialize(),this.scanForPanels(),setInterval((()=>this.scanForPanels()),200)}addRule(e){this.rules.push(e),this.scanForPanels()}scanForPanels(t){void 0===t&&(t=document);for(const n of this.rules)for(const s of t.querySelectorAll(n.selector)){if("true"===s.getAttribute(T))return;s.setAttribute(T,"true");const t=e({},n);delete t.selector,this.createPanel(s,t)}}resolvePendingRequests(){const e=this.pendingRequests;this.pendingRequests=null;for(const t of e)this.createPanel(...t)}createPanel(e,t){if(e=e||document.body,null!=this.pendingRequests)return void this.pendingRequests.push(arguments);if(Z(e)&&(e=[...document.querySelectorAll(e)]),Array.isArray(e)){e.length=Math.min(4,e.length);for(const n of e)this.createPanel(n,t);return}t=Qe(t);const n=new CleanupJobs;for(const e of["onFlowCheckpoint","onFlowFinish","onFlowSuccess","onMount"])if("function"==typeof t[e]){const s=He.addAnonymous(t[e]);t[e]=s,n.add((()=>He.delete(s)))}const s=t.gateType;if(!ve())return void console.error("[BlinkSDK] Blink SDK is inactive!");const i=e;let o,r;if(s===w.popup){const e=Ht.showModal(t);o=e.panel,r=e.handler}else{const e=s?Gt[s]:GateElement;if(null==e)return void console.error("[BlinkSDK] Unknown gate type",s);const n=t.panel;if(s===w.banner&&n&&this.cachedBannerGates.has(n)){const e=this.cachedBannerGates.get(n);r=e.getInteractiveHandlers(),o=e.panel,o.updateOptions(t)}else{o=new PanelElement(t);const a=new e(t,o);a.mount(i),r=a.getInteractiveHandlers(),s===w.banner&&this.cachedBannerGates.set(n,a)}}o.addCleanupJob(n),t.onFlowFinish&&o.flowFinish.addListener((function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return He.call(t.onFlowFinish,...n)})),t.onFlowCheckpoint&&o.flowCheckpoint.addListener((e=>He.call(t.onFlowCheckpoint,e)));const a=e=>{(s!==w.popup||e!==L&&e!==k)&&r.remove(),t.onFlowSuccess&&He.call(t.onFlowSuccess)};o.isFlowSuccess()?a():o.flowSuccess.addListener(a),t.onMount&&He.call(t.onMount,r)}createPopup(t){this.createPanel(document.body,e({},t,{gateType:w.popup}))}},Jt=new class UXFlowModule{init(){dt.addListener(tt.REDIRECT_TO_URL,(e=>{let{url:t,newTab:n,logOut:s}=e;s&&ft.setMerchantToken(null),function(e,t){void 0===e&&(e=""),void 0===t&&(t="_blank"),window.open(e,t,"opener")}(t||window.location.href,n?"_blank":"_self")})),dt.addListener(tt.START_FLOW_REQUEST,(e=>{let{flowType:t,options:n}=e;return this.enterFlow(t,n)}))}enterFlow(t,n){n.type=n.type||t,n.flowType=t;const s=e({flowType:n.type,journeyId:n.journeyId,journeyAlias:n.journeyAlias},n.metadata),i=Ee(n.panel);i&&(s.panelId=i.id,s.panelAlias=i.alias),lt(ot,s),!n.editRecurring&&(t===v.subscribe&&ft.userData.subscription||t===v.donation&&ft.isRecurringDonor())?ut.hideWallet?Kt.createPopup(e({},n,{type:v.dashboard})):Ht.changeRoute(yt.INDEX_EXPANDED):Kt.createPopup(n)}},Yt=50;let $t=null;const Xt=new Dispatcher;function Qt(e){return Z(e)&&(e=new URL(e,self.location.href)),e.pathname+(e.pathname.endsWith("/")?"":"/")}function Zt(e,t){return Qt(e)===Qt(t)}function en(){const e=Te.getItem(N.pageVisits);return new Map((null==e?void 0:e.v)||[])}function tn(t,n){let s=en();const i=Qt(t),o=Date.now(),r=e({firstVisit:o},s.get(i),n,{lastVisit:o});if(s.set(i,r),s.size>Yt){const e=[...s].sort(((e,t)=>t[1].lastVisit-e[1].lastVisit)).slice(0,Yt);s=new Map(e)}return Te.setItem(N.pageVisits,{v:[...s]}),[r,s]}function nn(e){const t=[location.pathname,...en().keys()];for(const n of t)if(Zt(e,n))return!0;return!1}function sn(e){return 0===Xt.listeners.length&&($t=self.location.href,setInterval((()=>{const e=self.location.href;e!==$t&&($t=e,Xt.dispatch(e))}),200)),e($t),Xt.addListener(e)}function on(e,t){tn(e,t),function(e){Xt.dispatch(e)}(e)}const rn=new class AnalyticsModule{constructor(){this.allEventsDispatcher=new Dispatcher,this.eventsByTypeDispatcher=new Dispatchable,this.shouldStoreCookies=null,this.client=new AnalyticsClient("sdk")}init(){sn((()=>this.updateEnvironment(this.getDefaultEnvironment()))),this.initDispatchers(),fe((()=>{if(!ve())return;const e=ye();if(!e)return;const t={merchantId:e},n=be();n&&n.alias&&(t.merchantAlias=n.alias),this.client.updateIdentity(t),this.broadcastEnvironment()})),mt.addListener((e=>{e.sendMessage(tt.UPDATE_ANALYTICS_DATA_FROM_SDK,{environment:this.client.environment,identity:this.client.identity,iframeSelector:st(e.node)})})),ft.authenticationChange.addListener((()=>{ft.userData.userId?this.client.identity.userId=ft.userData.userId:delete this.client.identity.userId,this.broadcastEnvironment()}))}setEnableStorage(e){e!==this.shouldStoreCookies&&(this.shouldStoreCookies=e,e?(this.localId=Te.getItem(N.merchantLocalId)||this.localId,this.sessionId=Ce.getItem(N.merchantSessionId)||this.sessionId):(delete this.localId,delete this.sessionId),this.initIdentity(),this.broadcastEnvironment())}initIdentity(){this.shouldStoreCookies&&(this.localId=this.localId||Te.getItem(N.merchantLocalId),this.localId||(this.localId=ae(),Te.setItem(N.merchantLocalId,this.localId)),this.sessionId=this.sessionId||Ce.getItem(N.merchantSessionId),this.sessionId||(this.sessionId=ae(),Ce.setItem(N.merchantSessionId,this.sessionId))),this.client.updateIdentity({localId:this.localId,sessionId:this.sessionId})}broadcastEnvironment(){pt.forEach((e=>{e.sendMessage(tt.UPDATE_ANALYTICS_DATA_FROM_SDK,{identity:this.client.identity,environment:this.client.environment})}))}getDefaultEnvironment(){return{referrerURL:ke(),url:window.location.href}}updateEnvironment(e,t){void 0===t&&(t=!0),this.client.updateEnvironment(e),t&&this.broadcastEnvironment()}initDispatchers(){this.client.addListener("event",(e=>{this.allEventsDispatcher.dispatch(e),this.eventsByTypeDispatcher.dispatch(e.type,e)})),dt.addListener(tt.ANALYTICS_EVENT,(e=>{let{event:t}=e;this.allEventsDispatcher.dispatch(t),this.eventsByTypeDispatcher.dispatch(t.type,t)}))}};function an(e){const t=e.reduce(((e,t)=>Math.max(e,t.priority||1)),1),n=(e=e.filter((e=>(e.priority||1)===t))).reduce(((e,t)=>e+(t.weight||1)),0),s=Math.random()*n;let i=0;for(const t of e)if(i+=t.weight||1,s<i)return t;return e[0]}class Condition extends Dispatchable{constructor(e,t,n){super(),this.ops=[],this.journey=e,this.options=t,this.requestReEval=()=>n()}evaluate(){return null}cleanup(){super.cleanup(),this.ops.forEach((e=>e.cleanup()))}}function ln(e,t){return class SimpleCondition extends Condition{constructor(){super(...arguments),t instanceof Dispatchable&&this.attachChangeListener(t,this.requestReEval),t instanceof Dispatcher&&this.attachListener(t,this.requestReEval)}evaluate(){return e(this.options,this.journey,this)}}}function dn(e,t,n,s,i){if(!e||!Z(e))return!1;const o=z(t||".*").map((e=>RegExp(`^${e}$`)));if(null!=z(n).map((e=>RegExp(`^${e}$`))).find((t=>t.test(e)||t.test(e+"/"))))return!1;if(null==o.find((t=>t.test(e)||t.test(e+"/"))))return!1;if(null!=s&&!(s=z(s)).find((t=>t&&Zt(t,e))))return!1;if(null!=i){const[t,n]=He.call(i,e);if(!t||!n)return!1}return!0}const hn={atLeast:"atLeast",exact:"exact",atMost:"atMost"},cn="mobile",un="desktop",pn=ln((function(e){const t=Me.get(e.key);return e.hasOwnProperty("equal")?t===e.equal:t}),Me),mn=new Dispatcher;function gn(e,t,n){document.cookie=`${e}=${t}; path=/; max-age=${n};`,mn.dispatch()}function fn(e){let t=(document.cookie||"").split(";");for(let n of t)if(n=n.trim(),n.startsWith(e+"="))return n.substring(e.length+1);return""}const yn=ln((function(e){const t=fn(e.key);return e.hasOwnProperty("equal")?t===e.equal:t}),mn),bn=5,vn=200;let wn=!1,An=null,En=new Dispatcher;const Sn=["pub_300x250","pub_300x250m","pub_728x90","text-ad","textAd","text_ad","text_ads","text-ads","text-ad-links","banner-ad-box","mod_ad_square","mod_ad_side","mod_ad_main","ad_title","ad_pic","banner-ad-box","ad-banner","ad960","index_ad_column2","index_ad_a6","index_ad_a5","index_ad_a4","mod_r_ad1","mod_r_ad","mod_index_ad","mod_ad_text","mod_ad_t25","index_ad_a2","hp_textlink_ad","head_ad","channel_ad_2016","ad_hover_href","adClose","top-ads","ad-bottom","ad-region","ad728x90","adCell","adVertical","adWrapper","ad_click","ad_content","ad_image","adpic","ads-image","ads_area","ads_title","adsense-right","advert-wide","advertiseText","b_adLastChild","banner-300x250","banner-728","block-ads","centered-ad","content_ad","contentad","detail-ads","google_adsense","gujAd","house-ad","internal-ad","is-sponsored","item-ad","jquery-script-ads","ligatus","middlead","native-ad","overlay-ad","related-ads","side-ads","sidead","sponsor-link","sticky-ad-wrapper","top-ads","vce-ad-below-header","vce-ad-container","video-ads","wide-ad","widget-ads"],Tn=["ad-left","adBannerWrap","ad-frame","ad-header","ad-img","ad-inner","ad-label","ad-lb","ad-footer","ad-container","ad-container-1","ad-container-2","Ad300x145","Ad300x250","Ad728x90","AdArea","AdFrame1","AdFrame2","AdFrame3","AdFrame4","AdLayer1","AdLayer2","Ads_google_01","Ads_google_02","Ads_google_03","Ads_google_04","DivAd","DivAd1","DivAd2","DivAd3","DivAdA","DivAdB","DivAdC","AdImage","AdDiv","AdBox160","AdContainer","glinkswrapper","adTeaser","banner_ad","adBanner","adAd","bannerad","ad_box","ad_channel","adserver","bannerid","adslot","popupad","adsense","google_ad","outbrain-paid","sponsored_link","adframe_wrap_ad","bunyad_ads_","l_qq_com","adzone_","sponsorText","dfp-tlb"],Cn={height:"1px",width:"1px",opacity:"1",position:"absolute",left:"-999px",top:"-999px"};function Pn(e){An=e,En.dispatch(e)}function In(e,t){!function(e){return!document.body.contains(e)||null!==window.document.body.getAttribute("abp")||0===e.clientHeight||0===e.clientWidth||0===e.offsetParent||0===e.offsetHeight||0===e.offsetLeft||0===e.offsetTop||0===e.offsetWidth||0===e.style.opacity||"hidden"===e.style.display||"none"===e.style.visibility}(t)?e===bn?Pn(!1):setTimeout((()=>{In(e+1,t)}),vn):Pn(!0)}function On(e){In(0,function(){const e=document.createElement("div");return e.id=Tn[Math.floor(Math.random()*Tn.length)],e.setAttribute("class",Sn.join(" ")),e.setAttribute("ad-id","googlead_"),Object.assign(e.style,Cn),document.body.appendChild(e),e}())}const xn={AND:"and",OR:"or",NOT:"not"},Dn=e({[xn.AND]:class AndCondition extends Condition{evaluate(){let e=!1;for(const t of this.ops){const n=t.evaluate();if(!1===n)return!1;e=e||null==n}return!e||null}},[xn.OR]:class OrCondition extends Condition{evaluate(){let e=!1;for(const t of this.ops){const n=t.evaluate();if(n)return!0;e=e||null==n}return!!e&&null}},[xn.NOT]:class NotCondition extends Condition{evaluate(){const e=this.ops[0].evaluate();return null==e?null:!e}},true:class TrueCondition extends Condition{evaluate(){return!0}},expr:class ExprCondition extends Condition{constructor(){super(...arguments),this.attachListener(Me,this.requestReEval)}evaluate(){return!!(new ExprEvaluator).eval(this.options.value)}},function:class FunctionCondition extends Condition{constructor(){super(...arguments),this.havePendingResult=!1,null!=this.options.event&&this.attachEventListener(window,this.options.event,this.requestReEval),null!=this.options.interval&&this.attachInterval(this.requestReEval,this.options.interval)}evaluateResult(e){return this.options.hasOwnProperty("equal")?e===this.options.equal:!!e}resolvePromiseResult(e){this.havePendingResult=!1,this.cachedResult=e,this.requestReEval()}evaluate(){if(null!=this.cachedResult)return this.evaluateResult(this.cachedResult);if(this.havePendingResult)return null;const[e,t]=He.call(this.options.function);return e?t instanceof Promise?(this.cachedResult=null,this.havePendingResult=!0,t.then((e=>this.resolvePromiseResult(e)),(()=>this.resolvePromiseResult(null))),null):this.evaluateResult(t):null}},variable:pn,inactive:class InactiveCondition extends Condition{constructor(){super(...arguments);let e=null;const t=()=>{this.isInactive=!1,clearTimeout(e),e=this.attachTimeout((()=>{this.isInactive=!0,this.requestReEval()}),1e3*this.options.seconds)};t(),this.attachEventListener(window,"mousemove",t),this.attachEventListener(window,"scroll",t),this.attachEventListener(window,"click",t)}evaluate(){return this.isInactive}},stayOnPage:class StayOnPageCondition extends Condition{constructor(){super(...arguments),this.stayedOnPage=!1,this.attachTimeout((()=>{this.stayedOnPage=!0,this.requestReEval()}),1e3*this.options.seconds)}evaluate(){return this.stayedOnPage}},pageScroll:class PageScrollCondition extends Condition{constructor(){super(...arguments),this.attachEventListener(window,"scroll",this.requestReEval)}evaluate(){var e,t;const n=null!=(e=null==(t=window.visualViewport)?void 0:t.pageTop)?e:window.scrollY,s=null!=(i=null==(o=window.visualViewport)?void 0:o.height)?i:window.innerHeight;var i,o;const r=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);let a=!0;if(null!=this.options.amount&&a&&(a=n>=this.options.amount),null!=this.options.fraction||null!=this.options.percent){var l;const e=null!=(l=this.options.fraction)?l:this.options.percent/100;a&&(a=n/(r-s)>=e)}return a}},nthPage:class NthPageVisitCondition extends Condition{constructor(){super(...arguments);const{numPages:e=1,activationType:t=hn.atLeast,scope:n=this.journey.alias,altScope:s,timeWindow:i}=this.options;sn((o=>{const r=Qt(o),a=this.testPath(r),[l,d]=tn(o,{[n]:a}),h=i?Date.now()-1e3*i:-1/0,c=[...d.values()].filter((e=>e.lastVisit>=h&&e[n])).length;Me.set(n+".count",c),s&&Me.set(s+".count",c);const u=this.cachedResult;this.cachedResult=a&&function(e,t,n){return n===hn.exact?e===t:n===hn.atMost?e<=t:e>=t}(c,e,t),function(e,t){return t===hn.exact||(t===hn.atMost?!0===e:!1===e)}(this.cachedResult,t)&&tn(o,{["numVisits."+n]:c}),null!=u&&this.requestReEval()}))}testPath(e){return dn(e,this.options.pathInclude,this.options.pathExclude,this.options.pathOneOf,this.options.filterFunction)}evaluate(){return this.cachedResult}},adBlockEnabled:ln((function(){return wn||(wn=!0,setTimeout((()=>On()),400)),An}),En),userAgent:class UserAgentCondition extends Condition{evaluate(){let e=!0;return this.options.device&&e&&(e=-1!==z(this.options.device).indexOf(q()?cn:un)),e}},utm:class UTMCondition extends Condition{evaluate(){const e=_e(),t=t=>!this.options.hasOwnProperty(t)||z(this.options[t]).indexOf(e[t])>=0;for(const e of _)if(!t(e))return!1;return!0}},path:class PathCondition extends Condition{evaluate(){return dn(window.location.pathname,this.options.includePattern,this.options.excludePattern,this.options.oneOf,this.options.filterFunction)}},referrer:class ReferrerCondition extends Condition{evaluate(){return dn(ke(),this.options.includePattern,this.options.excludePattern,this.options.oneOf,this.options.filterFunction)}},cookie:yn},function(){const e=ft.exposeMerchantFunctions();for(const[t,n]of Object.entries(e))e[t]=ln(n,ft.userPreferencesChange);return e}());class ScopedActionThrottler{constructor(e,t,n){this.cachedTimestamps=[],this.throttleRules=[],this.maxCount=0,this.name=e,this.storage=t;for(const e of n)this.throttleRules.push({duration:1e3*(e.duration||1/0),count:e.count}),e.count>this.maxCount&&(this.maxCount=e.count)}execute(e){const t=Date.now();let n=this.storage.getItem(this.name)||[...this.cachedTimestamps];n.sort();for(let e of this.throttleRules){const s=n.length-e.count;if(s>=0&&t-n[s]<e.duration)return!1}return n.push(t),n.length>this.maxCount&&(n=n.slice(n.length-this.maxCount)),e||(this.cachedTimestamps=n,this.storage.setItem(this.name,n)),!0}}class SessionActionThrottler{constructor(e,t){this.throttlers=[];for(const n of Object.values(Oe)){const s=t.filter((e=>e.scope===n||n===Oe.PERMANENT&&!e.scope));s.length&&this.throttlers.push(new ScopedActionThrottler(e,xe(n),s))}}execute(e){return!this.throttlers.filter((e=>!e.execute(!0))).length&&(e||this.throttlers.forEach((e=>e.execute())),!0)}}class JourneyActionRunner{constructor(e,t){void 0===t&&(t=!0);const{action:n,throttle:s}=e.options;if(this.journey=e,this.actions=z(n),t&&s){let t=Ve(z(s));this.throttler=new SessionActionThrottler(e.alias+"-throttle",t)}else this.throttler=null}runAction(){for(const e of this.actions)if(e.type===C.createPanel&&e.gateType===w.popup&&(Ht.isExpanded()||Ht.isPopupFlowActive()))return;if(null==this.throttler||this.throttler.execute())for(const e of this.actions)Nn(this.journey,e)}}function Nn(t,n){switch((n=Ve(n)).type||C.callback){case C.callback:for(const e of Object.keys(n))"type"!==e&&He.call([e,...z(n[e]),t]);break;case C.blinkAction:kn(n.blinkAction);break;case C.setVariable:for(const e of Object.keys(n))"type"!==e&&Me.set(e,n[e]);break;case C.editPanel:{const t=e({},n);delete t.type,delete t.panel,Ze(n.panel,t);break}case C.createPanel:{const{loop:s,selector:i}=n,o=e({},n,{journeyId:t.id,journeyAlias:t.alias});delete o.loop,delete o.type,s?Kt.addRule(o):(delete o.selector,Kt.createPanel(i,o));break}}}const _n={login:e=>Jt.enterFlow(v.auth,{panel:e}),donate:e=>Jt.enterFlow(v.donation,{panel:e,skipCTA:ft.isAuthenticated()}),giftSubscription:e=>Jt.enterFlow(v.giftSubscription,{panel:e}),subscribe:e=>Jt.enterFlow(v.subscribe,{panel:e}),newsletter:e=>Kt.createPopup({panel:e,type:v.newsletter,skipCTA:!0}),setToken:e=>{try{e=function(e,t){let{jsonFormat:n=!0}={};return e=atob(e),n&&(e=JSON.parse(e)),e}(e),ft.setMerchantToken({key:e.t,expiresAt:e.e})}catch(e){console.error("Failed to set the token",e)}},markVisit:e=>on(e),dashboard:e=>Kt.createPopup({panel:e,type:v.dashboard})};function kn(e){Z(e)&&(e=e.split(","));for(const t of z(e)){if(!Z(t)){new JourneyActionRunner({options:{action:t},alias:"inline_journey"},!1).runAction();continue}const e=t.split("!");if(0===e.length)continue;const n=we(e[0]);n?new JourneyActionRunner(n,!1).runAction():_n[e[0]]&&_n[e[0]](...e.slice(1))}}function Ln(t,n,s){Array.isArray(n)&&(n={type:xn.AND,ops:n}),n.exclude&&(n={type:xn.NOT,op:e({},n,{exclude:void 0})}),("string"==typeof n||n instanceof String)&&(n={type:n});const i=Dn[n.type];if(!i)throw`Unknown condition type: ${n.type}`;const o=new i(t,n,s);return n.type!==xn.AND&&n.type!==xn.OR||(o.ops=n.ops.map((e=>Ln(t,e,s)))),n.type===xn.NOT&&(o.ops=[Ln(t,n.op,s)]),o}class JourneyConditionEvaluator{constructor(e){this.journey=e,this.runner=new JourneyActionRunner(e);const t=Be((()=>this.evaluate()),0),n=Ve(e.options.condition||"true");this.condition=Ln(e,n,t),this.evaluate();for(const n of z(null==(s=e.options)?void 0:s.reeval)){var s;"auth"===n?ft.authenticationChange.addListener((()=>{var n;null==(n=this.condition)||n.cleanup();const s=Ve(e.options.condition||"true");this.condition=Ln(e,s,t),this.evaluate()})):console.warn("Unknown reeval condition",n)}}evaluate(){const e=this.condition.evaluate();e&&this.haveEvaluatedOnce&&console.debug("Running again",this.journey),e&&this.runner.runAction(),this.haveEvaluatedOnce=!0}cleanup(){this.condition.cleanup()}}function Rn(e){const{precondition:t}=e.options;if(!t)return!0;const n=Ln(e,t,se),s=n.evaluate();return n.cleanup(),null==s?(He.handleException(new Error(`Precondition for journey '${e.alias}' could not be evaluated synchronously.`),e.alias),!1):s}function Mn(e){return new JourneyConditionEvaluator(e)}const Fn=new class UserJourneyModule{init(t){var n;t=function(t){if(!t)return[];const n=[];for(let s of t){const t=[];for(const n of z(s)){if(!n)continue;let s=we(n.alias||n);s&&(Z(n)||(delete n.options,s=e({},s,n)),t.push(s))}t.length>0&&n.push(t)}return n}(t);const s=Te.getItem(N.selectedUserJourneys),i=new Set(null!=(n=null==s?void 0:s.aliases)?n:[]),o={};for(const e of t){let t=e.filter(Rn);if(0===t.length)continue;for(const e of t)if(i.has(e.alias)){t=[e];break}const n=an(t);i.add(n.alias),Te.setItem(N.selectedUserJourneys,{aliases:[...i]}),e.length>1&&(o[n.alias]=n.id),Object.keys(o).length&&rn.updateEnvironment({journeys:o}),Mn(n)}}},Bn=new class FacebookPixelModule{init(){const e=ge("MerchantFacebookPixel")[0];e&&(this.initFBQ(e.pixelId),dt.addListener(tt.FLOW_CHECKPOINT,(t=>{let{event:n,extra:s}=t;if("complete"===n.flowCheckpoint)if(n.flowType===k)this.submit(e.subscriptionConversionEvent,n,`subscription-${n.subscriptionId}`);else if("newsletter"===n.flowType){if(!s||!s.audienceMembers)return;for(const t of s.audienceMembers){const n=Se(t.audienceId);n&&"self_subscribed"===t.status&&t.subscribedAt&&this.submit(e.newsletterConversionEvent,{newsletter:n.name},`newsletter-${t.id}-${Math.round(+new Date(t.subscribedAt)/1e3)}`)}}else n.flowType===L&&this.submit(e.donationConversionEvent,n,`donation-${n.donationId}`)})))}submit(e,t,n){if(!e)return;const s=e.name,i=e.trackType,o={};for(const n of Object.keys(e.builtinCustomProperties||{})){var r;o[n]=String(null!=(r=t[e.builtinCustomProperties[n]])?r:"")}Object.assign(o,e.extraCustomProperties||{}),fbq(i,s,o,{eventID:n})}initFBQ(e){if(window.fbq)return;window.fbq=function(){fbq.callMethod?fbq.callMethod.apply(fbq,arguments):fbq.queue.push(arguments)},fbq.push=fbq,fbq.loaded=!0,fbq.version="2.0",fbq.queue=[],window._fbq=window._fbq||fbq;const t=document.createElement("script");t.async=!0,t.src="https://connect.facebook.net/en_US/fbevents.js";const n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),fbq("init",e),fbq("track","PageView")}};function Un(e){return e?ee(e)?(e.panel=e.panel||e.pgId||e.panelId||e.panelAlias,e):{panel:e}:{}}let jn=null;const qn={build:a,time:new Date(l)};let Wn=null,Hn=!1,zn=!1;const Vn=new class BlinkSDK{constructor(){this.PANEL_TYPE=v,this.GATE_TYPE=w,this.GATE_COVER_PANEL_POSITION=A,j(R),Object.assign(Le,e({},ft.exposeMerchantFunctions(),{chooseRandom:e=>e&&e[Math.floor(e.length*Math.random())],isURLViewed:nn,screenWidth:le,isSmallScreen:de,getQueryParam:re,setCookie:gn,getCookie:fn,getVariable:e=>Me.get(e),hasVariable:e=>Me.has(e),setVariable:(e,t,n)=>Me.set(e,t,n),deleteVariable:e=>Me.delete(e),addVariables:e=>Me.add(e),createPanel:(t,n)=>{const{loop:s,selector:i}=t;t=e({},t),n&&(t.journeyId=n.id,t.journeyAlias=n.alias),delete t.loop,s?Kt.addRule(t):(delete t.selector,Kt.createPanel(i,t))},editPanel:t=>Ze(t.panel,e({},t,{panel:void 0})),runBlinkAction:kn})),rn.init(),ft.init(),Wt.init(),Ht.init(),Kt.init(),Jt.init(),dt.addListener(tt.WIDGET_DATA_LOADED,(()=>{lt(it,U),window.dispatchEvent(new CustomEvent("blinkSDKSetup",{})),Wn.journeys&&Fn.init(Wn.journeys),Kt.resolvePendingRequests(),Wt.resolvePendingRequests(),kn(re("blinkaction")),window.dispatchEvent(new CustomEvent(y,{})),zn=!0}));const t=function(){try{return new URL(document.currentScript.src).searchParams.get("clientId")}catch(e){return null}}();t&&this.init({clientId:t})}doInit(t){Wn=e({storeAnalyticsCookies:!0},function(){const e=ge("MerchantSDKSettings")[0]||{};return e&&e.options||{}}(),t),Wn.allowUserToCoverFees&&ut.update({allowUserToCoverFees:Wn.allowUserToCoverFees}),Wn.variables&&Me.add(Wn.variables),rn.setEnableStorage(!!Wn.storeAnalyticsCookies),ut.update({hideWallet:!!Wn.hideWallet}),Ht.renderWallet(Wn.widgetPositionYOffset),Bn.init(),window.dispatchEvent(new CustomEvent("blinkPaywallInitialized",{})),j(B)}async init(e){Hn||(Hn=!0,async function(e){var t;const n=re("blinkversion"),s=n?e+"."+n:e,i=(r||o)+"/public_data."+s+".json";try{const e=await fetch(i);pe=await e.json()}catch(e){return void console.error("[BlinkSDK] Failed to load settings")}const a=ge("Merchant",null);ue=null==(t=a.find((t=>t.id==e||t.alias==e)))?void 0:t.id,ue?(j(M),me.dispatch(pe)):console.error("[BlinkSDK]: Unrecognized clientId or invalid settings version:",s)}(e.clientId||e.publisherDomainId),ht.addListener((e=>{jn=e,j(F)})),await Promise.all([ht.awaitOnce(),me.awaitOnce()]),this.doInit(e))}isInitialized(){return zn}setOptions(e){Hn?ut.update(e):this.init(e)}requestPayment(e,t,n){void 0===t&&(t=se),void 0===n&&(n=se),Wt.requestPayment(e,t,n)}createPanel(e,t){Kt.createPanel(e,Un(t))}createPopup(e){Kt.createPopup(Un(e))}promptAuth(e){Jt.enterFlow(v.auth,Un(e))}promptSubscription(e){Jt.enterFlow(v.subscribe,Un(e))}promptGiftSubscription(e){Jt.enterFlow(v.giftSubscription,Un(e))}promptDonation(e){Jt.enterFlow(v.donation,Un(e))}promptShop(e){Jt.enterFlow(v.shop,Un(e))}promptEmailNewsletter(t){Kt.createPopup(e({},Un(t),{type:v.newsletter,skipCTA:!0}))}promptManageAccount(t){this.createPopup(e({},Un(t),{type:v.dashboard}))}getUserData(){return ft.userData}isAuthenticated(){return ft.isAuthenticated()}isSubscribed(){return ft.isSubscriber()}getSubscription(){return ft.userData.subscription}getStore(e){return ge(e)}onAuthenticationChange(e,t){void 0===t&&(t=!1);const n=()=>e({authenticated:this.isAuthenticated()});if(ft.authenticationChange.addListener(n),t)if(zn)n();else{const e=()=>{n(),window.removeEventListener(y,e)};window.addEventListener(y,e)}}onSubscriptionChange(e){ft.subscriptionChange.addListener((()=>e(ft.userData.subscription)))}setAnalyticsStorageEnabled(e){rn.setEnableStorage(!!e)}showWallet(){this.setOptions({hideWallet:!1})}hideWallet(){this.setOptions({hideWallet:!0})}hasVariable(e){return Me.has(e)}getVariable(e){return Me.get(e)}setVariable(e,t,n){return void 0===n&&(n=Oe.MEMORY),Me.set(e,t,n)}evaluatePanelOptions(e){return Qe({panel:e})}allVariables(){return Me.all()}hasFunction(e){return!!He.get(e)}getFunction(e){return He.get(e)}addFunction(e,t){return He.add({[e]:t})}addFunctions(e){return He.add(e)}callFunction(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return He.call(e,...n)}allFunctions(){return He.all()}getExceptionHandler(){return He.exceptionHandler}setExceptionHandler(e){const t=He.exceptionHandler;return He.exceptionHandler=e,t}sendAnalyticsEvent(e){lt(rt,e)}addAnalyticsEventListener(e,t){const n=function(){try{t(...arguments)}catch(e){console.error(e)}};return"*"===e?rn.allEventsDispatcher.addListener(n):rn.eventsByTypeDispatcher.addListener(e,n)}getSplitJourneys(){var e,t;return null==(e=rn.client)||null==(t=e.environment)?void 0:t.journeys}getBuildVersion(){return{sdkVersion:qn,widgetVersion:jn}}printBuildVersion(){const e=this.getBuildVersion(),t=(e,t)=>{console.group(e),console.log("build: ",t.build),console.log("time: ",t.time),console.log("age: ",function(e){const t=Date.now()-e,n=36e5,s=864e5,i=parseInt(t/s,10),o=parseInt(t%s/n,10),r=parseInt(t%n/6e4,10);let a=`${r} minute${1===r?"":"s"} ago`;return(i||o)&&(a=`${o} hour${1===o?"":"s"}, `+a,i&&(a=`${i} day${1===i?"":"s"}, `+a)),a}(t.time)),console.groupEnd()};t("Blink SDK",e.sdkVersion),t("Iframe",e.widgetVersion)}runAction(e){kn(e)}markURLVisited(e,t){on(e,t)}testJourneyOptions(e){const t="test_journey_id_"+ae().replace(/-/g,"_"),n="test_journey_alias_"+ae().replace(/-/g,"_"),s=Mn({id:t,alias:n,options:e});return{id:t,alias:n,cleanup:()=>null==s?void 0:s.cleanup()}}setEnableAnalyticsStorage(e){this.setAnalyticsStorageEnabled(e)}promptSubscriptionPopup(e){this.promptSubscription(e)}promptGiftSubscriptionPopup(e){this.promptGiftSubscription(e)}promptDonationPopup(e){this.promptDonation(e)}onSubscriptionStatusChange(e){this.onSubscriptionChange((t=>e({subscribed:!!t})))}};return null==self.blink&&(self.blink=Vn),Vn}();
//# sourceMappingURL=blink-sdk.js.map